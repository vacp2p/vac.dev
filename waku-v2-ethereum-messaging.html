<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>[Talk] Vac, Waku v2 and Ethereum Messaging</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="description" content="Talk from Taipei Ethereum Meetup. Read on to find out about our journey from Whisper to Waku v2, as well as how Waku v2 can be useful for Etherum Messaging."/><link rel="shortcut icon" href="/assets/logo/vac/favicon.ico"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:creator" content="vacp2p"/><meta name="twitter:site" content="@vacp2p"/><meta name="twitter:title" content="[Talk] Vac, Waku v2 and Ethereum Messaging"/><meta name="twitter:description" content="Talk from Taipei Ethereum Meetup. Read on to find out about our journey from Whisper to Waku v2, as well as how Waku v2 can be useful for Etherum Messaging."/><meta name="twitter:image" content="https://staging.vac.dev/compiled-assets/img/taipei_ethereum_meetup_slide.png"/><meta property="og:url" content="https://staging.vac.dev//waku-v2-ethereum-messaging"/><meta property="og:image" content="https://staging.vac.dev/compiled-assets/img/taipei_ethereum_meetup_slide.png"/><meta property="og:site_name" content="[Talk] Vac, Waku v2 and Ethereum Messaging"/><meta property="og:title" content="[Talk] Vac, Waku v2 and Ethereum Messaging"/><meta property="og:description" content="Talk from Taipei Ethereum Meetup. Read on to find out about our journey from Whisper to Waku v2, as well as how Waku v2 can be useful for Etherum Messaging."/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/e068b41030ceede6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e068b41030ceede6.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cdd95df0746869ac.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cdd95df0746869ac.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-a14325fd952bf0eb.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-ada0258e433ba222.js" defer=""></script><script src="/_next/static/chunks/pages/_app-91f05ffa21c9a6ec.js" defer=""></script><script src="/_next/static/chunks/eb1842f2-90eb16656390ba2a.js" defer=""></script><script src="/_next/static/chunks/399-b4b9981c243e7c94.js" defer=""></script><script src="/_next/static/chunks/108-374a17adb21bb412.js" defer=""></script><script src="/_next/static/chunks/pages/%5B%5B...path%5D%5D-9c3054039bf889f4.js" defer=""></script><script src="/_next/static/-5vfLOflCSkQPJRugO7ZO/_buildManifest.js" defer=""></script><script src="/_next/static/-5vfLOflCSkQPJRugO7ZO/_ssgManifest.js" defer=""></script><script src="/_next/static/-5vfLOflCSkQPJRugO7ZO/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><svg width="0" height="0" xmlns="http://www.w3.org/2000/svg" style="display:none"><defs><filter id="colored"><feColorMatrix type="matrix" values="1.00 0 0 0 0 0 1.00 0 0 0 0 0 1.00 0 0 0 0 0 1 0"></feColorMatrix></filter></defs></svg><style nonce="logos">
      #nprogress {
        pointer-events: none;
      }
      #nprogress .bar {
        background: #000000;
        position: fixed;
        z-index: 9999;
        top: 0;
        left: 0;
        width: 100%;
        height: 3px;
      }
      #nprogress .peg {
        display: block;
        position: absolute;
        right: 0px;
        width: 100px;
        height: 100%;
        box-shadow: 0 0 10px #000000, 0 0 5px #000000;
        opacity: 1;
        -webkit-transform: rotate(3deg) translate(0px, -4px);
        -ms-transform: rotate(3deg) translate(0px, -4px);
        transform: rotate(3deg) translate(0px, -4px);
      }
      #nprogress .spinner {
        display: block;
        position: fixed;
        z-index: 1031;
        top: 15px;
        right: 15px;
      }
      #nprogress .spinner-icon {
        width: 18px;
        height: 18px;
        box-sizing: border-box;
        border: solid 2px transparent;
        border-top-color: #000000;
        border-left-color: #000000;
        border-radius: 50%;
        -webkit-animation: nprogresss-spinner 400ms linear infinite;
        animation: nprogress-spinner 400ms linear infinite;
      }
      .nprogress-custom-parent {
        overflow: hidden;
        position: relative;
      }
      .nprogress-custom-parent #nprogress .spinner,
      .nprogress-custom-parent #nprogress .bar {
        position: absolute;
      }
      @-webkit-keyframes nprogress-spinner {
        0% {
          -webkit-transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
        }
      }
      @keyframes nprogress-spinner {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style><div class="Style_container__qv2Yk Styles_common_container__u_XHj template-container"><header class="Styles_container__5FUI_ Style_header__IYvBP undefined"><div class="Styles_innerWrapper__ZInvp"><div class="logo-holder button vac" style="display:inline-block"><svg width="45" height="43" viewBox="0 0 35 43" fill="none" xmlns="http://www.w3.org/2000/svg" class="vac-logo"><g clip-path="url(#clip0_917_3082)"><path d="M24.9034 14.8217C24.6824 11.2666 23.5308 7.8298 21.5623 4.84994C22.543 4.19721 23.7374 3.93844 24.9034 4.12603C25.492 4.23064 26.0472 4.4722 26.5233 4.83086C26.9994 5.18951 27.3828 5.65504 27.6421 6.18916C28.0141 7.1512 28.1335 8.19117 27.989 9.21147C27.9754 9.6728 27.8955 10.1299 27.7516 10.5688C27.6613 10.8504 27.5322 11.1183 27.3682 11.3651C27.166 11.69 26.9466 12.0041 26.7109 12.3062C26.1084 13.1206 25.5607 14.0073 24.9034 14.8217Z" fill="#999999"></path><path d="M16.7058 7.58268C15.8382 5.99003 14.5344 4.67263 12.9447 3.78217L10.9546 2.69631C10.9546 2.69631 13.2551 -0.778436 16.1945 0.162641C19.134 1.10372 18.1846 7.4017 17.5821 9.80869" fill="#4D4D4D"></path><path d="M20.3209 41.6243C17.4179 40.4118 16.2129 38.3668 14.6975 36.919C13.1821 35.4711 12.8717 29.3903 13.1638 24.6126C13.456 19.8348 17.4909 11.528 17.5822 9.80869C17.6735 8.08941 15.4643 5.17569 13.5655 3.78217C11.6491 2.2631 9.29769 1.38272 6.84668 1.2666L8.36207 2.51534C9.74965 3.67359 9.42101 3.98125 9.22018 6.26155C9.01935 8.54185 8.72722 15.6904 8.70896 21.8436C8.70896 30.3495 6.73713 32.7022 13.0178 38.8373C14.1564 40.1358 15.6863 41.0368 17.3814 41.4072C21.6902 43.036 24.228 43.2712 20.3209 41.6243Z" fill="#1A1A1A"></path><path d="M17.9839 7.07618C17.5904 9.58823 16.8212 12.0281 15.7016 14.3152C14.6765 16.6746 13.7925 19.0918 13.0543 21.5543C12.076 25.3846 11.8405 29.3642 12.3605 33.2816C12.4325 34.6426 12.8065 35.9712 13.4559 37.1726C14.1362 38.1272 14.9759 38.9596 15.939 39.6338C17.8321 41.3312 20.1651 42.4718 22.6761 42.9276C20.068 40.8547 18.189 38.0165 17.3083 34.8199C16.3002 31.5246 16.6412 27.9684 18.2577 24.9205C18.7142 24.0699 19.2436 23.2555 19.7731 22.4411L24.4653 15.3287C24.7022 15.0187 24.8815 14.6694 24.9948 14.2971C25.0769 13.891 25.0769 13.4727 24.9948 13.0665C24.3347 9.48034 22.792 6.11109 20.5034 3.25758C19.9266 2.35717 19.1529 1.59688 18.2395 1.033C17.3262 0.46911 16.2966 0.116066 15.2269 0C15.7121 0.03052 16.1783 0.198543 16.5699 0.484084C16.9616 0.769625 17.2622 1.16066 17.4361 1.61069C17.8159 2.51034 18.0085 3.47679 18.0021 4.45202C18.0507 5.32627 18.0446 6.20267 17.9839 7.07618Z" fill="#808080"></path><path d="M34.927 21.7174C34.8742 21.5895 34.8068 21.4681 34.7261 21.3554C34.5725 21.0145 34.3893 20.6875 34.1784 20.3781C34.0141 20.1429 33.8315 19.9257 33.6489 19.7085C33.2107 19.1294 33.0829 18.3874 32.5352 17.8988C32.2726 17.6504 32.0907 17.33 32.0126 16.9787C31.9346 16.6273 31.964 16.2609 32.097 15.9261C32.2066 15.6366 32.4074 15.4013 32.5352 15.1298C32.6706 14.7258 32.7195 14.2982 32.6786 13.8744C32.6378 13.4505 32.5081 13.0398 32.2979 12.6685C31.7956 11.6016 31.1838 10.5888 30.4721 9.64624C29.5227 8.32511 28.5185 7.05828 27.4596 5.82764C27.6672 6.89431 27.6423 7.99266 27.3865 9.04902C27.2386 9.62495 27.0432 10.1879 26.8023 10.7321C26.4264 11.4007 26.0118 12.0473 25.5608 12.6685C23.2238 16.2881 20.832 19.9076 18.349 23.4004C17.0435 25.5573 16.3321 28.0161 16.2859 30.5309C16.0848 32.9993 16.618 35.472 17.8195 37.6433C18.5687 38.8742 19.4502 40.021 20.4486 41.0637C21.0694 41.7334 21.7814 42.8735 22.6395 43.0726C22.7491 42.041 22.9499 40.6475 23.096 39.6159C23.3338 37.934 23.8782 36.3089 24.7027 34.8201C25.1895 33.7601 26.0543 32.9158 27.1309 32.4493C27.9135 32.2862 28.7218 32.2862 29.5044 32.4493C29.9422 32.4221 30.3812 32.4221 30.819 32.4493C31.2686 32.4735 31.7149 32.3597 32.097 32.1235C32.3186 31.968 32.5024 31.7655 32.6351 31.5307C32.7677 31.2959 32.8459 31.0347 32.8638 30.7662C32.9186 30.2791 32.9186 29.7874 32.8638 29.3003C32.8245 28.9868 32.8685 28.6686 32.9916 28.3773C33.2473 27.8525 34.0141 27.6172 34.0689 27.02C34.0476 26.7523 33.9665 26.4927 33.8315 26.2599C33.7604 26.1456 33.7228 26.014 33.7228 25.8798C33.7228 25.7456 33.7604 25.614 33.8315 25.4998C33.8315 25.4998 34.0506 25.355 34.1236 25.2464C34.2051 25.1396 34.2492 25.0093 34.2492 24.8754C34.2492 24.7415 34.2051 24.6112 34.1236 24.5044C33.9428 24.2955 33.8006 24.0566 33.7037 23.7986C33.695 23.6656 33.715 23.5323 33.7622 23.4075C33.8094 23.2827 33.8828 23.1692 33.9776 23.0747C34.1732 22.888 34.3945 22.7295 34.6348 22.6041C34.7511 22.5516 34.8541 22.4739 34.9362 22.3769C35.0183 22.2798 35.0776 22.1658 35.1095 22.0431C35.0688 21.9246 35.0069 21.8143 34.927 21.7174Z" fill="#CCCCCC"></path><path d="M34.3062 20.5771C34.478 20.8248 34.619 21.0922 34.7261 21.3734C34.8037 21.4816 34.8709 21.5967 34.9269 21.7173L34.3062 20.5771Z" fill="#CCCCCC"></path><path d="M10.133 33.4262C9.0523 28.5693 8.7138 23.5789 9.12886 18.6223C9.12886 16.1429 11.265 2.44302 7.79605 1.41145C4.85656 0.524668 2.53783 3.94512 2.53783 3.94512C0.667683 7.68216 -0.206002 11.8316 1.36513e-05 15.9982C2.30048 38.8193 17.6735 41.4615 18.2577 41.7149C18.2577 41.7149 11.4476 39.2898 10.133 33.4262Z" fill="#09212A"></path></g><defs><clipPath id="clip0_917_3082"><rect width="35" height="43"></rect></clipPath></defs></svg></div><div class="Styles_searchBox__5X2m1"><div class="Styles_container__ddCFx "><div class="logos-search-box Styles_searchBox__xWHyX"><div><input type="text" placeholder="Search Vac Research" value=""/></div></div></div></div></div></header><div class="page-info"><h1 style="display:none">Vac Research</h1><div class="page-info-sub"><i>Mar 16 2023</i><br/><span>staging.vac.dev</span></div></div><main class="undefined Styles_common_main__4v7gP Styles_common_main__4v7gP"><aside class="Styles_container__3yUcn Style_sidebar__mLS5A Styles_common_sidebar__QAVov hidden-scroll Styles_hideDesktopToggleButton__L_Rik"><div class="sidebar-toggle-button button Styles_mobile___qAwf"><svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 4h14c.55 0 1-.45 1-1s-.45-1-1-1H1c-.55 0-1 .45-1 1s.45 1 1 1Zm14 8H1c-.55 0-1 .45-1 1s.45 1 1 1h14c.55 0 1-.45 1-1s-.45-1-1-1Zm0-5H1c-.55 0-1 .45-1 1s.45 1 1 1h14c.55 0 1-.45 1-1s-.45-1-1-1Z" fill="#F2F2F2"></path></svg></div><div class="logo-holder button vac" style="display:inline-block"><svg width="45" height="43" viewBox="0 0 35 43" fill="none" xmlns="http://www.w3.org/2000/svg" class="vac-logo"><g clip-path="url(#clip0_917_3082)"><path d="M24.9034 14.8217C24.6824 11.2666 23.5308 7.8298 21.5623 4.84994C22.543 4.19721 23.7374 3.93844 24.9034 4.12603C25.492 4.23064 26.0472 4.4722 26.5233 4.83086C26.9994 5.18951 27.3828 5.65504 27.6421 6.18916C28.0141 7.1512 28.1335 8.19117 27.989 9.21147C27.9754 9.6728 27.8955 10.1299 27.7516 10.5688C27.6613 10.8504 27.5322 11.1183 27.3682 11.3651C27.166 11.69 26.9466 12.0041 26.7109 12.3062C26.1084 13.1206 25.5607 14.0073 24.9034 14.8217Z" fill="#999999"></path><path d="M16.7058 7.58268C15.8382 5.99003 14.5344 4.67263 12.9447 3.78217L10.9546 2.69631C10.9546 2.69631 13.2551 -0.778436 16.1945 0.162641C19.134 1.10372 18.1846 7.4017 17.5821 9.80869" fill="#4D4D4D"></path><path d="M20.3209 41.6243C17.4179 40.4118 16.2129 38.3668 14.6975 36.919C13.1821 35.4711 12.8717 29.3903 13.1638 24.6126C13.456 19.8348 17.4909 11.528 17.5822 9.80869C17.6735 8.08941 15.4643 5.17569 13.5655 3.78217C11.6491 2.2631 9.29769 1.38272 6.84668 1.2666L8.36207 2.51534C9.74965 3.67359 9.42101 3.98125 9.22018 6.26155C9.01935 8.54185 8.72722 15.6904 8.70896 21.8436C8.70896 30.3495 6.73713 32.7022 13.0178 38.8373C14.1564 40.1358 15.6863 41.0368 17.3814 41.4072C21.6902 43.036 24.228 43.2712 20.3209 41.6243Z" fill="#1A1A1A"></path><path d="M17.9839 7.07618C17.5904 9.58823 16.8212 12.0281 15.7016 14.3152C14.6765 16.6746 13.7925 19.0918 13.0543 21.5543C12.076 25.3846 11.8405 29.3642 12.3605 33.2816C12.4325 34.6426 12.8065 35.9712 13.4559 37.1726C14.1362 38.1272 14.9759 38.9596 15.939 39.6338C17.8321 41.3312 20.1651 42.4718 22.6761 42.9276C20.068 40.8547 18.189 38.0165 17.3083 34.8199C16.3002 31.5246 16.6412 27.9684 18.2577 24.9205C18.7142 24.0699 19.2436 23.2555 19.7731 22.4411L24.4653 15.3287C24.7022 15.0187 24.8815 14.6694 24.9948 14.2971C25.0769 13.891 25.0769 13.4727 24.9948 13.0665C24.3347 9.48034 22.792 6.11109 20.5034 3.25758C19.9266 2.35717 19.1529 1.59688 18.2395 1.033C17.3262 0.46911 16.2966 0.116066 15.2269 0C15.7121 0.03052 16.1783 0.198543 16.5699 0.484084C16.9616 0.769625 17.2622 1.16066 17.4361 1.61069C17.8159 2.51034 18.0085 3.47679 18.0021 4.45202C18.0507 5.32627 18.0446 6.20267 17.9839 7.07618Z" fill="#808080"></path><path d="M34.927 21.7174C34.8742 21.5895 34.8068 21.4681 34.7261 21.3554C34.5725 21.0145 34.3893 20.6875 34.1784 20.3781C34.0141 20.1429 33.8315 19.9257 33.6489 19.7085C33.2107 19.1294 33.0829 18.3874 32.5352 17.8988C32.2726 17.6504 32.0907 17.33 32.0126 16.9787C31.9346 16.6273 31.964 16.2609 32.097 15.9261C32.2066 15.6366 32.4074 15.4013 32.5352 15.1298C32.6706 14.7258 32.7195 14.2982 32.6786 13.8744C32.6378 13.4505 32.5081 13.0398 32.2979 12.6685C31.7956 11.6016 31.1838 10.5888 30.4721 9.64624C29.5227 8.32511 28.5185 7.05828 27.4596 5.82764C27.6672 6.89431 27.6423 7.99266 27.3865 9.04902C27.2386 9.62495 27.0432 10.1879 26.8023 10.7321C26.4264 11.4007 26.0118 12.0473 25.5608 12.6685C23.2238 16.2881 20.832 19.9076 18.349 23.4004C17.0435 25.5573 16.3321 28.0161 16.2859 30.5309C16.0848 32.9993 16.618 35.472 17.8195 37.6433C18.5687 38.8742 19.4502 40.021 20.4486 41.0637C21.0694 41.7334 21.7814 42.8735 22.6395 43.0726C22.7491 42.041 22.9499 40.6475 23.096 39.6159C23.3338 37.934 23.8782 36.3089 24.7027 34.8201C25.1895 33.7601 26.0543 32.9158 27.1309 32.4493C27.9135 32.2862 28.7218 32.2862 29.5044 32.4493C29.9422 32.4221 30.3812 32.4221 30.819 32.4493C31.2686 32.4735 31.7149 32.3597 32.097 32.1235C32.3186 31.968 32.5024 31.7655 32.6351 31.5307C32.7677 31.2959 32.8459 31.0347 32.8638 30.7662C32.9186 30.2791 32.9186 29.7874 32.8638 29.3003C32.8245 28.9868 32.8685 28.6686 32.9916 28.3773C33.2473 27.8525 34.0141 27.6172 34.0689 27.02C34.0476 26.7523 33.9665 26.4927 33.8315 26.2599C33.7604 26.1456 33.7228 26.014 33.7228 25.8798C33.7228 25.7456 33.7604 25.614 33.8315 25.4998C33.8315 25.4998 34.0506 25.355 34.1236 25.2464C34.2051 25.1396 34.2492 25.0093 34.2492 24.8754C34.2492 24.7415 34.2051 24.6112 34.1236 24.5044C33.9428 24.2955 33.8006 24.0566 33.7037 23.7986C33.695 23.6656 33.715 23.5323 33.7622 23.4075C33.8094 23.2827 33.8828 23.1692 33.9776 23.0747C34.1732 22.888 34.3945 22.7295 34.6348 22.6041C34.7511 22.5516 34.8541 22.4739 34.9362 22.3769C35.0183 22.2798 35.0776 22.1658 35.1095 22.0431C35.0688 21.9246 35.0069 21.8143 34.927 21.7174Z" fill="#CCCCCC"></path><path d="M34.3062 20.5771C34.478 20.8248 34.619 21.0922 34.7261 21.3734C34.8037 21.4816 34.8709 21.5967 34.9269 21.7173L34.3062 20.5771Z" fill="#CCCCCC"></path><path d="M10.133 33.4262C9.0523 28.5693 8.7138 23.5789 9.12886 18.6223C9.12886 16.1429 11.265 2.44302 7.79605 1.41145C4.85656 0.524668 2.53783 3.94512 2.53783 3.94512C0.667683 7.68216 -0.206002 11.8316 1.36513e-05 15.9982C2.30048 38.8193 17.6735 41.4615 18.2577 41.7149C18.2577 41.7149 11.4476 39.2898 10.133 33.4262Z" fill="#09212A"></path></g><defs><clipPath id="clip0_917_3082"><rect width="35" height="43"></rect></clipPath></defs></svg></div><div class="Styles_desktop__VH2y3 defaultSidebar Styles_container__4YC7p"><nav class="sidebarNav hidden-scroll"><ul class="sidebar-menu mainMenu Styles_menu__izFC1"><li class="Styles_menuItem__BqRqE menuitem level-0"><span></span><ul class="sidebar-menu  Styles_menu__izFC1"><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Main" href="/">Main</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="principles" href="/principles">Principles</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Research areas" href="/research-areas">Research areas</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Projects" href="/projects">Projects</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Open Research Problems" href="/open-problems">Open Research Problems</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="publications" href="/publications">Publications</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="contribute" href="/contribute">Contribute</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="media" href="/media">Media</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li></ul><br/></li></ul><br/><ul class="sidebar-menu subMenu Styles_menu__izFC1"><li class="Styles_menuItem__BqRqE menuitem level-0"><a class="" title="research" href="/research">Research</a><ul class="sidebar-menu  Styles_menu__izFC1"><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Waku for All Decentralized Applications and Infrastructures" href="/waku-for-all">Waku for All Decentralized Applications and Infrastructures</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Building Privacy-Protecting Infrastructure" href="/building-privacy-protecting-infrastructure">Building Privacy-Protecting Infrastructure</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Waku Privacy and Anonymity Analysis Part I: Definitions and Waku Relay" href="/wakuv2-relay-anon">Waku Privacy and Anonymity Analysis Part I: Definitions and Waku Relay</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Noise handshakes as key-exchange mechanism for Waku" href="/wakuv2-noise">Noise handshakes as key-exchange mechanism for Waku</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Waku v2 Ambient Peer Discovery" href="/wakuv2-apd">Waku v2 Ambient Peer Discovery</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Introducing nwaku" href="/introducing-nwaku">Introducing nwaku</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li class="Styles_menuItem__BqRqE menuitem level-1"><a class="" title="Opinion: Pseudo-ethics in the Surveillance Tech Industry" href="/ethics-surveillance-tech">Opinion: Pseudo-ethics in the Surveillance Tech Industry</a><ul class="sidebar-menu  Styles_menu__izFC1"></ul></li><li><span class="button">...</span></li></ul><br/></li></ul><div class="external_links"><div><div class="menuitem-title"><span class="cap">Resources</span></div><ul><li><a href="https://rfc.vac.dev/" target="_blank">&gt; Specs/RFCs</a></li><li><a href="https://forum.vac.dev/" target="_blank">&gt; Forum</a></li><li><a href="https://waku.org" target="_blank">&gt; Waku.org</a></li></ul></div></div></nav></div></aside><article class="Styles_container__pG0bG Style_content__NTXHZ Styles_common_content__Myi5Z"><div class="Style_container__qc2tD"><h2 class="Style_container__eSI4Q serif">[Talk] Vac, Waku v2 and Ethereum Messaging</h2><div class="serif"><i>Nov 10 2020</i><i> - </i>by<!-- --><a title="oskarth" href="/authors/oskarth"><span><i> <!-- -->oskarth<!-- --></i></span></a></div></div><p><em>The following post is a transcript of the talk given at the <!-- --><a href="https://www.meetup.com/Taipei-Ethereum-Meetup/events/274033344/">Taipei Ethereum meetup, November 5<!-- --></a>. There is also a <!-- --><a href="https://www.youtube.com/watch?v=lUDy1MoeYnI">video recording<!-- --></a>.<!-- --></em></p>
<!-- --><hr/>
<!-- --><h2><a class="anchor" id="0-introduction"></a><a class="ha" href="#0-introduction">0. Introduction<!-- --></a></h2>
<!-- --><p>Hi! My name is Oskar and I&#x27;m the protocol research lead at Vac. This talk will be divided into two parts. First I&#x27;ll talk about the journey from Whisper, to Waku v1 and now to Waku v2. Then I&#x27;ll talk about messaging in Ethereum. After this talk, you should have an idea of what Waku v2 is, the problems it is trying to solve, as well as where it can be useful for messaging in Ethereum.<!-- --></p>
<!-- --><h2><a class="anchor" id="part-1---vac-and-the-journey-from-whisper-to-waku-v1-to-waku-v2"></a><a class="ha" href="#part-1---vac-and-the-journey-from-whisper-to-waku-v1-to-waku-v2">PART 1 - VAC AND THE JOURNEY FROM WHISPER TO WAKU V1 TO WAKU V2<!-- --></a></h2>
<!-- --><h2><a class="anchor" id="1-vac-intro"></a><a class="ha" href="#1-vac-intro">1. Vac intro<!-- --></a></h2>
<!-- --><p>First, what is Vac? Vac grew out of our efforts Status to create a window on to Ethereum and secure messenger. Vac is modular protocol stack for p2p secure messaging, paying special attention to resource restricted devices, privacy and censorship resistance.<!-- --></p>
<!-- --><p>Today we are going to talk mainly about Waku v2, which is the transport privacy / routing aspect of the Vac protocol stack. It sits &quot;above&quot; the p2p overlay, such as libp2p dealing with transports etc, and below a conversational security layer dealing with messaging encryption, such as using Double Ratchet etc.<!-- --></p>
<!-- --><h2><a class="anchor" id="2-whisper-to-waku-v1"></a><a class="ha" href="#2-whisper-to-waku-v1">2. Whisper to Waku v1<!-- --></a></h2>
<!-- --><p>In the beginning, there was Whisper. Whisper was part of the holy trinity of Ethereum. You had Ethereum for consensus/computation, Whisper for messaging, and Swarm for storage.<!-- --></p>
<!-- --><p>However, for various reasons, Whisper didn&#x27;t get the attention it deserved. Development dwindled, it promised too much and it suffered from many issues, such as being extremely inefficient and not being suitable for running on e.g. mobile phone. Despite this, Status used it in its app from around 2017 to 2019. As far as I know, it was one of very few, if not the only, production uses of Whisper.<!-- --></p>
<!-- --><p>In an effort to solve some of its immediate problems, we forked Whisper into Waku and formalized it with a proper specification. This solved immediate bandwidth issues for light nodes, introduced rate limiting for better spam protection, improved historical message support, etc.<!-- --></p>
<!-- --><p>If you are interested in this journey, checkout the <!-- --><a href="https://www.youtube.com/watch?v=6lLT33tsJjs">EthCC talk Dean and I gave in Paris earlier this year<!-- --></a>.<!-- --></p>
<!-- --><p>Status upgraded to Waku v1 early 2020. What next?<!-- --></p>
<!-- --><h2><a class="anchor" id="3-waku-v1-to-v2"></a><a class="ha" href="#3-waku-v1-to-v2">3. Waku v1 to v2<!-- --></a></h2>
<!-- --><p>We were far from done. The changes we had made were quite incremental and done in order to get tangible improvements as quickly as possible. This meant we couldn&#x27;t address more fundamental issues related to full node routing scalability, running with libp2p for more transports, better security, better spam protection and incentivization.<!-- --></p>
<!-- --><p>This kickstarted Waku v2 efforts, which is what we&#x27;ve been working on since July. This work was and is initally centered around a few pieces:<!-- --></p>
<!-- --><p>(a) Moving to libp2p<!-- --></p>
<!-- --><p>(b) Better routing<!-- --></p>
<!-- --><p>(c) Accounting and user-run nodes<!-- --></p>
<!-- --><p>The general theme was: making the Waku network more scalable and robust.<!-- --></p>
<!-- --><p>We also did a scalability study to show at what point the network would run into issues, due to the inherent lack of routing that Whisper and Waku v1 provided.<!-- --></p>
<!-- --><p>You can read more about this <!-- --><a href="https://vac.dev/waku-v2-plan">here<!-- --></a>.<!-- --></p>
<!-- --><h2><a class="anchor" id="35-waku-v2---design-goals"></a><a class="ha" href="#35-waku-v2---design-goals">3.5 Waku v2 - Design goals<!-- --></a></h2>
<!-- --><p>Taking a step back, what problem does Waku v2 attempt to solve compared to all the other solutions that exists out there? What type of applications should use it and why? We have the following design goals:<!-- --></p>
<!-- --><ol>
<!-- --><li>
<!-- --><p><strong>Generalized messaging<!-- --></strong>. Many applications requires some form of messaging protocol to communicate between different subsystems or different nodes. This messaging can be human-to-human or machine-to-machine or a mix.<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Peer-to-peer<!-- --></strong>. These applications sometimes have requirements that make them suitable for peer-to-peer solutions.<!-- --></p>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Resource restricted<!-- --></strong>. These applications often run in constrained environments, where resources or the environment is restricted in some fashion. E.g.:<!-- --></p>
<!-- --><ul>
<!-- --><li>limited bandwidth, CPU, memory, disk, battery, etc<!-- --></li>
<!-- --><li>not being publicly connectable<!-- --></li>
<!-- --><li>only being intermittently connected; mostly-offline<!-- --></li>
<!-- --></ul>
<!-- --></li>
<!-- --><li>
<!-- --><p><strong>Privacy<!-- --></strong>. These applications have a desire for some privacy guarantees, such as pseudonymity, metadata protection in transit, etc.<!-- --></p>
<!-- --></li>
<!-- --></ol>
<!-- --><p>As well as to do so in a modular fashion. Meaning you can find a reasonable trade-off depending on your exact requirements. For example, you usually have to trade off some bandwidth to get metadata protection, and vice versa.<!-- --></p>
<!-- --><p>The concept of designing for resource restricted devices also leads to the concept of adaptive nodes, where you have more of a continuum between full nodes and light nodes. For example, if you switch your phone from mobile data to WiFi you might be able to handle more bandwidth, and so on.<!-- --></p>
<!-- --><h2><a class="anchor" id="4-waku-v2---breakdown"></a><a class="ha" href="#4-waku-v2---breakdown">4. Waku v2 - Breakdown<!-- --></a></h2>
<!-- --><p>Where is Waku v2 at now, and how is it structured?<!-- --></p>
<!-- --><p>It is running over libp2p and we had our second internal testnet last week or so. As a side note, we name our testnets after subway stations in Taipei, the first one being Nangang, and the most recent one being Dingpu.<!-- --></p>
<!-- --><p>The main implementation is written in Nim using nim-libp2p, which is also powering Nimbus, an Ethereum 2 client. There is also a PoC for running Waku v2 in the browser. On a spec level, we have the following specifications that corresponds to the components that make up Waku v2:<!-- --></p>
<!-- --><ul>
<!-- --><li>Waku v2 - this is the main spec that explains the goals of providing generalized messaging, in a p2p context, with a focus on privacy and running on resources restricted devices.<!-- --></li>
<!-- --><li>Relay - this is the main PubSub spec that provides better routing. It builds on top of GossipSub, which is what Eth2 heavily relies on as well.<!-- --></li>
<!-- --><li>Store - this is a 1-1 protocol for light nodes to get historical messages, if they are mostly-offline.<!-- --></li>
<!-- --><li>Filter - this is a 1-1 protocol for light nodes that are bandwidth restricted to only (or mostly) get messages they care about.<!-- --></li>
<!-- --><li>Message - this explains the payload, to get some basic encryption and content topics. It corresponds roughly to envelopes in Whisper/Waku v1.<!-- --></li>
<!-- --><li>Bridge - this explains how to do bridging between Waku v1 and Waku v2 for compatibility.<!-- --></li>
<!-- --></ul>
<!-- --><p>Right now, all protocols, with the exception of bridge, are in draft mode, meaning they have been implemented but are not yet being relied upon in production.<!-- --></p>
<!-- --><p>You can read more about the breakdown in this <!-- --><a href="https://vac.dev/waku-v2-update">update<!-- --></a> though some progress has been made since then, as well was in the <!-- --><a href="https://rfc.vac.dev/spec/10">main Waku v2 spec<!-- --></a>.<!-- --></p>
<!-- --><h2><a class="anchor" id="5-waku-v2---upcoming"></a><a class="ha" href="#5-waku-v2---upcoming">5. Waku v2 - Upcoming<!-- --></a></h2>
<!-- --><p>What&#x27;s coming up next? There are a few things.<!-- --></p>
<!-- --><p>For Status to use it in production, it needs to be integrated into the main app using the Nim Node API. The bridge also needs to be implemented and tested.<!-- --></p>
<!-- --><p>For other users, we are currently overhauling the API to allow usage from a browser, e.g. To make this experience great, there are also a few underlying infrastructure things that we need in nim-libp2p, such as a more secure HTTP server in Nim, Websockets and WebRTC support.<!-- --></p>
<!-- --><p>There are also some changes we made to at what level content encryption happens, and this needs to be made easier to use in the API. This means you can use a node without giving your keys to it, which is useful in some environments.<!-- --></p>
<!-- --><p>More generally, beyond getting to production-ready use, there are a few bigger pieces that we are working on or will work on soon. These are things like:<!-- --></p>
<!-- --><ul>
<!-- --><li>Better scaling, by using topic sharding.<!-- --></li>
<!-- --><li>Accounting and user-run nodes, to account for and incentives full nodes.<!-- --></li>
<!-- --><li>Stronger and more rigorous privacy guarantees, e.g. through study of GossipSub, unlinkable packet formats, etc.<!-- --></li>
<!-- --><li>Rate Limit Nullifier for privacy preserving spam protection, a la what Barry Whitehat has presented before.<!-- --></li>
<!-- --></ul>
<!-- --><p>As well as better support for Ethereum M2M Messaging. Which is what I&#x27;ll talk about next.<!-- --></p>
<!-- --><h2><a class="anchor" id="part-2---ethereum-messaging"></a><a class="ha" href="#part-2---ethereum-messaging">PART 2 - ETHEREUM MESSAGING<!-- --></a></h2>
<!-- --><p>A lot of what follows is inspired by exploratory work that John Lea has done at Status, previously Head of UX Architecture at Ubuntu.<!-- --></p>
<!-- --><h2><a class="anchor" id="6-ethereum-messaging---why"></a><a class="ha" href="#6-ethereum-messaging---why">6. Ethereum Messaging - Why?<!-- --></a></h2>
<!-- --><p>It is easy to think that Waku v2 is only for human to human messaging, since that&#x27;s how Waku is currently primarily used in the Status app. However, the goal is to be useful for generalized messaging, which includes other type of information as well as machine to machine messaging.<!-- --></p>
<!-- --><p>What is Ethereum M2M messaging? Going back to the Holy Trinity of Ethereum/Whisper/Swarm, the messaging component was seen as something that could facilitate messages between dapps and acts as a building block. This can help with things such as:<!-- --></p>
<!-- --><ul>
<!-- --><li>Reducing on-chain transactions<!-- --></li>
<!-- --><li>Reduce latency for operations<!-- --></li>
<!-- --><li>Decentralize centrally coordinated services (like WalletConnect)<!-- --></li>
<!-- --><li>Improve UX of dapps<!-- --></li>
<!-- --><li>Broadcast live information<!-- --></li>
<!-- --><li>A message transport layer for state channels<!-- --></li>
<!-- --></ul>
<!-- --><p>And so on.<!-- --></p>
<!-- --><h2><a class="anchor" id="7-ethereum-messaging---why-cont"></a><a class="ha" href="#7-ethereum-messaging---why-cont">7. Ethereum Messaging - Why? (Cont)<!-- --></a></h2>
<!-- --><p>What are some examples of practical things Waku as used for Ethereum Messaging could solve?<!-- --></p>
<!-- --><ul>
<!-- --><li>Multisig transfers only needing one on chain transaction<!-- --></li>
<!-- --><li>DAO votes only needing one one chain transaction<!-- --></li>
<!-- --><li>Giving dapps ability to direct push notifications to users<!-- --></li>
<!-- --><li>Giving users ability to directly respond to requests from daps<!-- --></li>
<!-- --><li>Decentralized Wallet Connect<!-- --></li>
<!-- --></ul>
<!-- --><p>Etc.<!-- --></p>
<!-- --><h2><a class="anchor" id="8-whats-needed-to-deliver-this"></a><a class="ha" href="#8-whats-needed-to-deliver-this">8. What&#x27;s needed to deliver this?<!-- --></a></h2>
<!-- --><p>We can break it down into our actors:<!-- --></p>
<!-- --><ul>
<!-- --><li>Decentralized M2M messaging system (Waku)<!-- --></li>
<!-- --><li>Native wallets (Argent, Metamask, Status, etc)<!-- --></li>
<!-- --><li>Dapps that benefit from M2M messaging<!-- --></li>
<!-- --><li>Users whose problems are being solved<!-- --></li>
<!-- --></ul>
<!-- --><p>Each of these has a bunch of requirements in turn. The messaging system needs to be decentralized, scalable, robust, etc. Wallets need support for messaging layer, dapps need to integrate this, etc.<!-- --></p>
<!-- --><p>This is a lot! Growing adoption is a challenge. There is a catch 22 in terms of justifying development efforts for wallets, when no dapps need it, and likewise for dapps when no wallets support Waku. In addition to this, there must be proven usage of Waku before it can be relied on, etc. How can we break this up into smaller pieces of work?<!-- --></p>
<!-- --><h2><a class="anchor" id="9-breaking-up-the-problem-and-a-high-level-roadmap"></a><a class="ha" href="#9-breaking-up-the-problem-and-a-high-level-roadmap">9. Breaking up the problem and a high level roadmap<!-- --></a></h2>
<!-- --><p>We can start small. It doesn&#x27;t and need to be used for critical features first. A more hybrid approach can be taken where it acts more as nice-to-haves.<!-- --></p>
<!-- --><ol>
<!-- --><li>Forking Whisper and solving scalablity, spam etc issues with it.
This is a work in progress. What we talked about in part 1.<!-- --></li>
<!-- --><li>Expose messaging API for Dapp developers.<!-- --></li>
<!-- --><li>Implement decentralized version of WalletConnect.
Currently wallets connect ot dapps with centralized service. Great UX.<!-- --></li>
<!-- --><li>Solve DAO/Multi-Sig coordination problem.
E.g. send message to wallet-derived key when it is time to sign a transaction.<!-- --></li>
<!-- --><li>Extend dapp-to-user and user-to-dapp communication to more dapps.
Use lessons learned and examples to drive adoptation for wallets/dapps.<!-- --></li>
<!-- --></ol>
<!-- --><p>And then build up from there.<!-- --></p>
<!-- --><h2><a class="anchor" id="10-we-are-hiring"></a><a class="ha" href="#10-we-are-hiring">10. We are hiring!<!-- --></a></h2>
<!-- --><p>A lot of this will happen in Javascript and browsers, since that&#x27;s the primarily environment for a lot of wallets and dapps. We are currently hiring for a Waku JS Wallet integration lead to help push this effort further.<!-- --></p>
<!-- --><p>Come talk to me after or <!-- --><a href="https://status.im/our_team/open_positions.html?gh_jid=2385338">apply here<!-- --></a>.<!-- --></p>
<!-- --><p>That&#x27;s it! You can find us on Status, Telegram, vac.dev. I&#x27;m on twitter <!-- --><a href="https://twitter.com/oskarth">here<!-- --></a>.<!-- --></p>
<!-- --><p>Questions?<!-- --></p>
<!-- --><hr/></article><aside class="Styles_container__3DqFl Style_toc__v7JJe Styles_common_toc__nMHyQ hidden-scroll"><nav class="Styles_tocComponent__fhPld hidden-scroll"><ul><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#introduction">Introduction</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#part-1-vac-and-the-journey-from-whisper-to-waku-v1-to-waku-v2">PART 1 - VAC AND THE JOURNEY FROM WHISPER TO WAKU V1 TO WAKU V2</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#vac-intro">Vac intro</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#whisper-to-waku-v1">Whisper to Waku v1</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#waku-v1-to-v2">Waku v1 to v2</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#3-5-waku-v2-design-goals">3.5 Waku v2 - Design goals</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#waku-v2-breakdown">Waku v2 - Breakdown</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#waku-v2-upcoming">Waku v2 - Upcoming</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#part-2-ethereum-messaging">PART 2 - ETHEREUM MESSAGING</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#ethereum-messaging-why">Ethereum Messaging - Why?</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#ethereum-messaging-why-cont">Ethereum Messaging - Why? (Cont)</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#what-s-needed-to-deliver-this">What&#x27;s needed to deliver this?</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#breaking-up-the-problem-and-a-high-level-roadmap">Breaking up the problem and a high level roadmap</a></li><li class="h-2"><a class="" href="/waku-v2-ethereum-messaging#we-are-hiring">We are hiring!</a></li></ul></nav></aside></main><footer class="Styles_container___YkOC undefined Styles_common_footer__1rPoh"><div class="footer-content-container Styles_content__0jn9p"><div><p><span class="copy-left">Â©</span><span>2023<!-- --></span><span> Vac Research</span><span> - </span><span>Vac - Communication, Privacy, Etc</span></p></div><div class="Styles_bottomPart__CsMh_"><div class="Styles_socialMedia__AmAKz "><span><a href="https://twitter.com/vacp2p" class="button"><svg xmlns="http://www.w3.org/2000/svg" width="30" viewBox="0 0 543.684 543.684" xml:space="preserve"><path d="M527.657 106.697a231.362 231.362 0 0 1-8.041 2.191c-16.384 4.137-17.89-1.322-6.028-13.366a109.306 109.306 0 0 0 14.082-17.607c9.137-14.217 1.212-20.417-14.333-13.776a224.853 224.853 0 0 1-16.897 6.432c-16.017 5.379-38.746-2.735-53.018-11.787-18.018-11.426-38.495-17.136-61.438-17.136-32.137 0-59.529 11.334-82.192 33.984-22.656 22.662-33.99 50.062-33.99 82.191 0 4.394.251 8.855.747 13.378.814 7.362-11.585 12.699-28.317 10.336-36.194-5.11-70.582-16.077-103.171-32.889-32.32-16.671-60.845-37.65-85.57-62.938-11.819-12.086-27.804-11.045-32.217 5.27-2.644 9.78-3.959 19.951-3.959 30.515 0 19.908 4.675 38.372 14.027 55.392 4.651 8.47 10.098 16.138 16.353 22.999 10.521 11.549 8.911 18.25-5.734 14.144-14.639-4.106-25.367-10.202-25.367-9.804v.722c0 28.048 8.807 52.693 26.432 73.911 10.857 13.072 23.47 23.17 37.834 30.282 15.147 7.503 22.203 11.688 13.733 12.784-5.11.661-10.251.991-15.422.991-3.5 0-7.172-.159-11.003-.483-6.059-.514-7.148 12.111 2.038 26.298 7.301 11.273 16.646 21.193 28.03 29.762 11.579 8.721 24.058 14.981 37.417 18.794 16.255 4.633 19.517 13.073 5.024 21.763-35.863 21.519-75.551 32.277-119.058 32.277-4.902 0-9.578-.11-14.045-.324-7.754-.373-2.552 6.456 12.417 14.296 46.775 24.499 97.43 36.738 151.972 36.738 41.237 0 79.964-6.529 116.176-19.596 36.199-13.066 67.136-30.576 92.791-52.516 25.655-21.94 47.779-47.173 66.365-75.711 18.581-28.537 32.424-58.33 41.543-89.376 9.106-31.053 13.666-62.167 13.666-93.342 0-2.809-.024-5.331-.067-7.552-.086-4.174 10.955-15.472 23.28-27.032a242.397 242.397 0 0 0 15.937-16.444c11.179-12.688 6.228-18.502-9.997-13.771z"></path></svg></a></span><span><a href="https://discord.gg/PQFdubGt6d" class="button"><svg width="30" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#discord_svg__a)"><path d="M60.105 4.898A58.55 58.55 0 0 0 45.653.415a.22.22 0 0 0-.233.11 40.784 40.784 0 0 0-1.8 3.697c-5.456-.817-10.886-.817-16.23 0-.485-1.164-1.201-2.587-1.828-3.697a.228.228 0 0 0-.233-.11 58.386 58.386 0 0 0-14.451 4.483.207.207 0 0 0-.095.082C1.578 18.73-.944 32.144.293 45.39a.244.244 0 0 0 .093.167c6.073 4.46 11.955 7.167 17.729 8.962a.23.23 0 0 0 .249-.082 42.08 42.08 0 0 0 3.627-5.9.225.225 0 0 0-.123-.312 38.772 38.772 0 0 1-5.539-2.64.228.228 0 0 1-.022-.378c.372-.279.744-.569 1.1-.862a.22.22 0 0 1 .23-.03c11.619 5.304 24.198 5.304 35.68 0a.219.219 0 0 1 .233.027c.356.293.728.586 1.103.865a.228.228 0 0 1-.02.378 36.384 36.384 0 0 1-5.54 2.637.227.227 0 0 0-.121.315 47.249 47.249 0 0 0 3.624 5.897.225.225 0 0 0 .249.084c5.801-1.794 11.684-4.502 17.757-8.961a.228.228 0 0 0 .092-.164c1.48-15.315-2.48-28.618-10.497-40.412a.18.18 0 0 0-.093-.084Zm-36.38 32.427c-3.497 0-6.38-3.211-6.38-7.156 0-3.944 2.827-7.156 6.38-7.156 3.583 0 6.438 3.24 6.382 7.156 0 3.945-2.827 7.156-6.381 7.156Zm23.593 0c-3.498 0-6.38-3.211-6.38-7.156 0-3.944 2.826-7.156 6.38-7.156 3.582 0 6.437 3.24 6.38 7.156 0 3.945-2.798 7.156-6.38 7.156Z" fill="#23272A"></path></g><defs><clipPath id="discord_svg__a"><path fill="#fff" d="M0 0h71v55H0z"></path></clipPath></defs></svg></a></span><span><a href="https://github.com/vacp2p" class="button"><svg width="30" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M512 0C229.12 0 0 229.12 0 512c0 226.56 146.56 417.92 350.08 485.76 25.6 4.48 35.2-10.88 35.2-24.32 0-12.16-.64-52.48-.64-95.36-128.64 23.68-161.92-31.36-172.16-60.16-5.76-14.72-30.72-60.16-52.48-72.32-17.92-9.6-43.52-33.28-.64-33.92 40.32-.64 69.12 37.12 78.72 52.48 46.08 77.44 119.68 55.68 149.12 42.24 4.48-33.28 17.92-55.68 32.64-68.48-113.92-12.8-232.96-56.96-232.96-252.8 0-55.68 19.84-101.76 52.48-137.6-5.12-12.8-23.04-65.28 5.12-135.68 0 0 42.88-13.44 140.8 52.48 40.96-11.52 84.48-17.28 128-17.28 43.52 0 87.04 5.76 128 17.28 97.92-66.56 140.8-52.48 140.8-52.48 28.16 70.4 10.24 122.88 5.12 135.68 32.64 35.84 52.48 81.28 52.48 137.6 0 196.48-119.68 240-233.6 252.8 18.56 16 34.56 46.72 34.56 94.72 0 68.48-.64 123.52-.64 140.8 0 13.44 9.6 29.44 35.2 24.32C877.44 929.92 1024 737.92 1024 512 1024 229.12 794.88 0 512 0Z" fill="#1B1F23"></path></svg></a></span></div><nav class="Styles_legal__0ciDG"><a title="Privacy Policy" href="/privacy-policy">Privacy Policy</a></nav></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"markdown":{"content":"\n*The following post is a transcript of the talk given at the [Taipei Ethereum meetup, November 5](https://www.meetup.com/Taipei-Ethereum-Meetup/events/274033344/). There is also a [video recording]( https://www.youtube.com/watch?v=lUDy1MoeYnI).*\n\n---\n\n## 0. Introduction\n\nHi! My name is Oskar and I'm the protocol research lead at Vac. This talk will be divided into two parts. First I'll talk about the journey from Whisper, to Waku v1 and now to Waku v2. Then I'll talk about messaging in Ethereum. After this talk, you should have an idea of what Waku v2 is, the problems it is trying to solve, as well as where it can be useful for messaging in Ethereum.\n\n## PART 1 - VAC AND THE JOURNEY FROM WHISPER TO WAKU V1 TO WAKU V2\n\n## 1. Vac intro\n\nFirst, what is Vac? Vac grew out of our efforts Status to create a window on to Ethereum and secure messenger. Vac is modular protocol stack for p2p secure messaging, paying special attention to resource restricted devices, privacy and censorship resistance.\n\nToday we are going to talk mainly about Waku v2, which is the transport privacy / routing aspect of the Vac protocol stack. It sits \"above\" the p2p overlay, such as libp2p dealing with transports etc, and below a conversational security layer dealing with messaging encryption, such as using Double Ratchet etc.\n\n## 2. Whisper to Waku v1\n\nIn the beginning, there was Whisper. Whisper was part of the holy trinity of Ethereum. You had Ethereum for consensus/computation, Whisper for messaging, and Swarm for storage.\n\nHowever, for various reasons, Whisper didn't get the attention it deserved. Development dwindled, it promised too much and it suffered from many issues, such as being extremely inefficient and not being suitable for running on e.g. mobile phone. Despite this, Status used it in its app from around 2017 to 2019. As far as I know, it was one of very few, if not the only, production uses of Whisper.\n\nIn an effort to solve some of its immediate problems, we forked Whisper into Waku and formalized it with a proper specification. This solved immediate bandwidth issues for light nodes, introduced rate limiting for better spam protection, improved historical message support, etc.\n\nIf you are interested in this journey, checkout the [EthCC talk Dean and I gave in Paris earlier this year](https://www.youtube.com/watch?v=6lLT33tsJjs).\n\nStatus upgraded to Waku v1 early 2020. What next?\n\n## 3. Waku v1 to v2\n\nWe were far from done. The changes we had made were quite incremental and done in order to get tangible improvements as quickly as possible. This meant we couldn't address more fundamental issues related to full node routing scalability, running with libp2p for more transports, better security, better spam protection and incentivization.\n\nThis kickstarted Waku v2 efforts, which is what we've been working on since July. This work was and is initally centered around a few pieces:\n\n(a) Moving to libp2p\n\n(b) Better routing\n\n(c) Accounting and user-run nodes\n\nThe general theme was: making the Waku network more scalable and robust.\n\nWe also did a scalability study to show at what point the network would run into issues, due to the inherent lack of routing that Whisper and Waku v1 provided.\n\nYou can read more about this [here](https://vac.dev/waku-v2-plan).\n\n## 3.5 Waku v2 - Design goals\n\nTaking a step back, what problem does Waku v2 attempt to solve compared to all the other solutions that exists out there? What type of applications should use it and why? We have the following design goals:\n\n1. **Generalized messaging**. Many applications requires some form of messaging protocol to communicate between different subsystems or different nodes. This messaging can be human-to-human or machine-to-machine or a mix.\n\n2. **Peer-to-peer**. These applications sometimes have requirements that make them suitable for peer-to-peer solutions.\n\n3. **Resource restricted**. These applications often run in constrained environments, where resources or the environment is restricted in some fashion. E.g.:\n\n    - limited bandwidth, CPU, memory, disk, battery, etc\n    - not being publicly connectable\n    - only being intermittently connected; mostly-offline\n\n4. **Privacy**. These applications have a desire for some privacy guarantees, such as pseudonymity, metadata protection in transit, etc.\n\nAs well as to do so in a modular fashion. Meaning you can find a reasonable trade-off depending on your exact requirements. For example, you usually have to trade off some bandwidth to get metadata protection, and vice versa.\n\nThe concept of designing for resource restricted devices also leads to the concept of adaptive nodes, where you have more of a continuum between full nodes and light nodes. For example, if you switch your phone from mobile data to WiFi you might be able to handle more bandwidth, and so on.\n\n## 4. Waku v2 - Breakdown\n\nWhere is Waku v2 at now, and how is it structured?\n\nIt is running over libp2p and we had our second internal testnet last week or so. As a side note, we name our testnets after subway stations in Taipei, the first one being Nangang, and the most recent one being Dingpu.\n\nThe main implementation is written in Nim using nim-libp2p, which is also powering Nimbus, an Ethereum 2 client. There is also a PoC for running Waku v2 in the browser. On a spec level, we have the following specifications that corresponds to the components that make up Waku v2:\n\n-   Waku v2 - this is the main spec that explains the goals of providing generalized messaging, in a p2p context, with a focus on privacy and running on resources restricted devices.\n-   Relay - this is the main PubSub spec that provides better routing. It builds on top of GossipSub, which is what Eth2 heavily relies on as well.\n-   Store - this is a 1-1 protocol for light nodes to get historical messages, if they are mostly-offline.\n-   Filter - this is a 1-1 protocol for light nodes that are bandwidth restricted to only (or mostly) get messages they care about.\n-   Message - this explains the payload, to get some basic encryption and content topics. It corresponds roughly to envelopes in Whisper/Waku v1.\n-   Bridge - this explains how to do bridging between Waku v1 and Waku v2 for compatibility.\n\nRight now, all protocols, with the exception of bridge, are in draft mode, meaning they have been implemented but are not yet being relied upon in production.\n\nYou can read more about the breakdown in this [update](https://vac.dev/waku-v2-update) though some progress has been made since then, as well was in the [main Waku v2 spec](https://rfc.vac.dev/spec/10).\n\n## 5. Waku v2 - Upcoming\n\nWhat's coming up next? There are a few things.\n\nFor Status to use it in production, it needs to be integrated into the main app using the Nim Node API. The bridge also needs to be implemented and tested.\n\nFor other users, we are currently overhauling the API to allow usage from a browser, e.g. To make this experience great, there are also a few underlying infrastructure things that we need in nim-libp2p, such as a more secure HTTP server in Nim, Websockets and WebRTC support.\n\nThere are also some changes we made to at what level content encryption happens, and this needs to be made easier to use in the API. This means you can use a node without giving your keys to it, which is useful in some environments.\n\nMore generally, beyond getting to production-ready use, there are a few bigger pieces that we are working on or will work on soon. These are things like:\n\n-   Better scaling, by using topic sharding.\n-   Accounting and user-run nodes, to account for and incentives full nodes.\n-   Stronger and more rigorous privacy guarantees, e.g. through study of GossipSub, unlinkable packet formats, etc.\n-   Rate Limit Nullifier for privacy preserving spam protection, a la what Barry Whitehat has presented before.\n\nAs well as better support for Ethereum M2M Messaging. Which is what I'll talk about next.\n\n## PART 2 - ETHEREUM MESSAGING\n\nA lot of what follows is inspired by exploratory work that John Lea has done at Status, previously Head of UX Architecture at Ubuntu.\n\n## 6. Ethereum Messaging - Why?\n\nIt is easy to think that Waku v2 is only for human to human messaging, since that's how Waku is currently primarily used in the Status app. However, the goal is to be useful for generalized messaging, which includes other type of information as well as machine to machine messaging.\n\nWhat is Ethereum M2M messaging? Going back to the Holy Trinity of Ethereum/Whisper/Swarm, the messaging component was seen as something that could facilitate messages between dapps and acts as a building block. This can help with things such as:\n\n-   Reducing on-chain transactions\n-   Reduce latency for operations\n-   Decentralize centrally coordinated services (like WalletConnect)\n-   Improve UX of dapps\n-   Broadcast live information\n-   A message transport layer for state channels\n\nAnd so on.\n\n## 7. Ethereum Messaging - Why? (Cont)\n\nWhat are some examples of practical things Waku as used for Ethereum Messaging could solve?\n\n-   Multisig transfers only needing one on chain transaction\n-   DAO votes only needing one one chain transaction\n-   Giving dapps ability to direct push notifications to users\n-   Giving users ability to directly respond to requests from daps\n-   Decentralized Wallet Connect\n\nEtc.\n\n## 8. What's needed to deliver this?\n\nWe can break it down into our actors:\n\n- Decentralized M2M messaging system (Waku)\n- Native wallets (Argent, Metamask, Status, etc)\n- Dapps that benefit from M2M messaging\n- Users whose problems are being solved\n\nEach of these has a bunch of requirements in turn. The messaging system needs to be decentralized, scalable, robust, etc. Wallets need support for messaging layer, dapps need to integrate this, etc.\n\nThis is a lot! Growing adoption is a challenge. There is a catch 22 in terms of justifying development efforts for wallets, when no dapps need it, and likewise for dapps when no wallets support Waku. In addition to this, there must be proven usage of Waku before it can be relied on, etc. How can we break this up into smaller pieces of work?\n\n## 9. Breaking up the problem and a high level roadmap\n\nWe can start small. It doesn't and need to be used for critical features first. A more hybrid approach can be taken where it acts more as nice-to-haves.\n\n1.  Forking Whisper and solving scalablity, spam etc issues with it.\n    This is a work in progress. What we talked about in part 1.\n2.  Expose messaging API for Dapp developers.\n3.  Implement decentralized version of WalletConnect.\n    Currently wallets connect ot dapps with centralized service. Great UX.\n4.  Solve DAO/Multi-Sig coordination problem.\n    E.g. send message to wallet-derived key when it is time to sign a transaction.\n5.  Extend dapp-to-user and user-to-dapp communication to more dapps.\n    Use lessons learned and examples to drive adoptation for wallets/dapps.\n\nAnd then build up from there.\n\n## 10. We are hiring!\n\nA lot of this will happen in Javascript and browsers, since that's the primarily environment for a lot of wallets and dapps. We are currently hiring for a Waku JS Wallet integration lead to help push this effort further.\n\nCome talk to me after or [apply here](https://status.im/our_team/open_positions.html?gh_jid=2385338).\n\nThat's it! You can find us on Status, Telegram, vac.dev. I'm on twitter [here](https://twitter.com/oskarth).\n\nQuestions?\n\n---\n","metadata":{"layout":"post","name":"[Talk] Vac, Waku v2 and Ethereum Messaging","title":"[Talk] Vac, Waku v2 and Ethereum Messaging","date":"2020-11-10T12:00:00.000Z","author":"oskarth","published":true,"permalink":"/waku-v2-ethereum-messaging","categories":"research","summary":"Talk from Taipei Ethereum Meetup. Read on to find out about our journey from Whisper to Waku v2, as well as how Waku v2 can be useful for Etherum Messaging.","image":"/img/taipei_ethereum_meetup_slide.png","discuss":"https://forum.vac.dev/t/discussion-talk-vac-waku-v2-and-ethereum-messaging/60"},"toc":[{"content":"Introduction","slug":"introduction","lvl":2,"i":0,"seen":0},{"content":"PART 1 - VAC AND THE JOURNEY FROM WHISPER TO WAKU V1 TO WAKU V2","slug":"part-1-vac-and-the-journey-from-whisper-to-waku-v1-to-waku-v2","lvl":2,"i":1,"seen":0},{"content":"Vac intro","slug":"vac-intro","lvl":2,"i":2,"seen":0},{"content":"Whisper to Waku v1","slug":"whisper-to-waku-v1","lvl":2,"i":3,"seen":0},{"content":"Waku v1 to v2","slug":"waku-v1-to-v2","lvl":2,"i":4,"seen":0},{"content":"3.5 Waku v2 - Design goals","slug":"3-5-waku-v2-design-goals","lvl":2,"i":5,"seen":0},{"content":"Waku v2 - Breakdown","slug":"waku-v2-breakdown","lvl":2,"i":6,"seen":0},{"content":"Waku v2 - Upcoming","slug":"waku-v2-upcoming","lvl":2,"i":7,"seen":0},{"content":"PART 2 - ETHEREUM MESSAGING","slug":"part-2-ethereum-messaging","lvl":2,"i":8,"seen":0},{"content":"Ethereum Messaging - Why?","slug":"ethereum-messaging-why","lvl":2,"i":9,"seen":0},{"content":"Ethereum Messaging - Why? (Cont)","slug":"ethereum-messaging-why-cont","lvl":2,"i":10,"seen":0},{"content":"What's needed to deliver this?","slug":"what-s-needed-to-deliver-this","lvl":2,"i":11,"seen":0},{"content":"Breaking up the problem and a high level roadmap","slug":"breaking-up-the-problem-and-a-high-level-roadmap","lvl":2,"i":12,"seen":0},{"content":"We are hiring!","slug":"we-are-hiring","lvl":2,"i":13,"seen":0}]},"navProps":{"metadata":{"published":true,"title":"[Talk] Vac, Waku v2 and Ethereum Messaging","layout":"post","name":"[Talk] Vac, Waku v2 and Ethereum Messaging","date":"2020-11-10T12:00:00.000Z","author":"oskarth","permalink":"/waku-v2-ethereum-messaging","categories":"research","summary":"Talk from Taipei Ethereum Meetup. Read on to find out about our journey from Whisper to Waku v2, as well as how Waku v2 can be useful for Etherum Messaging.","image":"img/taipei_ethereum_meetup_slide.png","discuss":"https://forum.vac.dev/t/discussion-talk-vac-waku-v2-and-ethereum-messaging/60"},"navOrder":1605009600,"localPath":"research/2020-11-10-waku-v2-ethereum-messaging.md","path":["waku-v2-ethereum-messaging"],"children":[],"isDir":false},"routeParams":{"path":["waku-v2-ethereum-messaging"]}},"__N_SSG":true},"page":"/[[...path]]","query":{"path":["waku-v2-ethereum-messaging"]},"buildId":"-5vfLOflCSkQPJRugO7ZO","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>