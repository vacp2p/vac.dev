"use strict";(self.webpackChunkvac_dev=self.webpackChunkvac_dev||[]).push([[4633],{72897:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var n=a(87462),o=(a(67294),a(3905));const i={layout:"post",name:"[Talk at COSCUP] Vac, Waku v2 and Ethereum Messaging",title:"[Talk at COSCUP] Vac, Waku v2 and Ethereum Messaging",date:new Date("2021-08-06T12:00:00.000Z"),authors:"oskarth",published:!0,slug:"waku-v2-ethereum-coscup",categories:"research",image:"/img/coscup-waku/talk.png",discuss:"https://forum.vac.dev/t/discussion-talk-at-coscup-vac-waku-v2-and-ethereum-messaging/95"},r=void 0,s={permalink:"/rlog/waku-v2-ethereum-coscup",source:"@site/rlog/2021-08-06-coscup-waku-ethereum.mdx",title:"[Talk at COSCUP] Vac, Waku v2 and Ethereum Messaging",description:"Learn more about Waku v2, its origins, goals, protocols, implementation and ongoing research. Understand how it is used and how it can be useful for messaging in Ethereum.",date:"2021-08-06T12:00:00.000Z",formattedDate:"August 6, 2021",tags:[],readingTime:7.12,hasTruncateMarker:!0,authors:[{name:"Oskar",twitter:"oskarth",github:"oskarth",key:"oskarth"}],frontMatter:{layout:"post",name:"[Talk at COSCUP] Vac, Waku v2 and Ethereum Messaging",title:"[Talk at COSCUP] Vac, Waku v2 and Ethereum Messaging",date:"2021-08-06T12:00:00.000Z",authors:"oskarth",published:!0,slug:"waku-v2-ethereum-coscup",categories:"research",image:"/img/coscup-waku/talk.png",discuss:"https://forum.vac.dev/t/discussion-talk-at-coscup-vac-waku-v2-and-ethereum-messaging/95"},prevItem:{title:"Waku v1 vs Waku v2: Bandwidth Comparison",permalink:"/rlog/waku-v1-v2-bandwidth-comparison"},nextItem:{title:"Presenting JS-Waku: Waku v2 in the Browser",permalink:"/rlog/presenting-js-waku"}},l={authorsImageUrls:[void 0]},u=[{value:"Introduction",id:"introduction",level:2},{value:"Brief history and background",id:"brief-history-and-background",level:2},{value:"Waku v2",id:"waku-v2",level:2},{value:"Overview",id:"overview",level:3},{value:"Goals",id:"goals",level:3},{value:"Protocols",id:"protocols",level:3},{value:"Implementations",id:"implementations",level:3},{value:"Testnet Huilong and dogfooding",id:"testnet-huilong-and-dogfooding",level:3},{value:"Research",id:"research",level:3},{value:"Use cases",id:"use-cases",level:2},{value:"Prelude: Topics in Waku v2",id:"prelude-topics-in-waku-v2",level:3},{value:"Status app",id:"status-app",level:3},{value:"DappConnect: Ethereum messaging",id:"dappconnect-ethereum-messaging",level:3},{value:"WalletConnect v2",id:"walletconnect-v2",level:3},{value:"More examples",id:"more-examples",level:3},{value:"Contribute",id:"contribute",level:2},{value:"Conclusion",id:"conclusion",level:2}],p={toc:u};function c(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Learn more about Waku v2, its origins, goals, protocols, implementation and ongoing research. Understand how it is used and how it can be useful for messaging in Ethereum."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This is the English version of a talk originally given in Chinese at COSCUP in Taipei.")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=s0ATpQ4_XFc"},"video recording with Chinese and English subtitles.")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"Hi everyone!"),(0,o.kt)("p",null,"Today I'll talk to you about Waku v2. What it is, what problems it is solving,\nand how it can be useful for things such as messaging in Ethereum. First, let me\nstart with some brief background."),(0,o.kt)("h2",{id:"brief-history-and-background"},"Brief history and background"),(0,o.kt)("p",null,'Back when Ethereum got started, there used to be this concept of the "holy\ntrinity". You had Ethereum for compute/consensus, Swarm for storage, and Whisper\nfor messaging. This is partly where the term Web3 comes from.'),(0,o.kt)("p",null,"Status started out as an app with the goal of being a window onto Ethereum and\na secure messenger. As one of the few, if not the only, apps using Whisper in\nproduction, not to mention on a mobile phone, we quickly realized there were\nproblems with the underlying protocols and infrastructure. Protocols such as\nWhisper weren't quite ready for prime time yet when it came to things such as\nscalability and working in the real world."),(0,o.kt)("p",null,"As we started addressing some of these challenges, and moved from app\ndevelopement to focusing on protocols, research and infrastructure, we created\nVac. Vac is an r&d unit doing protocol research focused on creating modular p2p\nmessaging protocols for private, secure, censorship resistant communication."),(0,o.kt)("p",null,"I won't go into too much detail on the issues with Whisper, if you are\ninterested in this check out this talk\n",(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=6lLT33tsJjs"},"here")," or this\n",(0,o.kt)("a",{parentName:"p",href:"https://vac.dev/fixing-whisper-with-waku"},"article"),"."),(0,o.kt)("p",null,"In a nutshell, we forked Whisper to address immediate shortcomings and this\nbecame Waku v1. Waku v2 is complete re-thought implementation from scratch on top\nof libp2p. This will be the subject of today's talk."),(0,o.kt)("h2",{id:"waku-v2"},"Waku v2"),(0,o.kt)("h3",{id:"overview"},"Overview"),(0,o.kt)("p",null,"Waku v2 is a privacy-preserving peer-to-peer messaging protocol for resource\nrestricted devices. We can look at Waku v2 as several things:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Set of protocols"),(0,o.kt)("li",{parentName:"ul"},"Set of implementations"),(0,o.kt)("li",{parentName:"ul"},"Network of nodes")),(0,o.kt)("p",null,"Let's first look at what the goals are."),(0,o.kt)("h3",{id:"goals"},"Goals"),(0,o.kt)("p",null,"Waku v2 provides a PubSub based messaging protocol with the following\ncharacteristics:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Generalized messaging"),". Applications that require a messaging protocol to\ncommunicate human to human, machine to machine, or a mix."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Peer-to-peer"),". For applications that require a p2p solution."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Resource restricted"),". For example, running with limited bandwidth, being\nmostly-offline, or in a browser."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Privacy"),". Applications that have privacy requirements, such as pseudonymity,\nmetadata protection, etc.")),(0,o.kt)("p",null,"And to provide these properties in a modular fashion, where applications can\nchoose their desired trade-offs."),(0,o.kt)("h3",{id:"protocols"},"Protocols"),(0,o.kt)("p",null,"Waku v2 consists of several protocols. Here we highlight a few of the most\nimportant ones:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"10/WAKU2 - main specification, details how all the pieces fit together"),(0,o.kt)("li",{parentName:"ul"},"11/RELAY - thin layer on top of GossipSub for message dissemination"),(0,o.kt)("li",{parentName:"ul"},"13/STORE - fetching of historical messages"),(0,o.kt)("li",{parentName:"ul"},"14/MESSAGE - message payload")),(0,o.kt)("p",null,"This is the recommended subset for a minimal Waku v2 client."),(0,o.kt)("p",null,"In addition to this there are many other types of specifications at various\nstages of maturity, such as: content based filtering, bridge mode to Waku v1,\nJSON RPC API, zkSNARKS based spam protection with RLN, accounting and\nsettlements with SWAP, fault-tolerant store nodes, recommendations around topic\nusage, and more."),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/"},"https://rfc.vac.dev/")," for a full overview."),(0,o.kt)("h3",{id:"implementations"},"Implementations"),(0,o.kt)("p",null,"Waku v2 consists of multiple implementations. This allows for client diversity,\nmakes it easier to strengthen the protocols, and allow people to use Waku v2 in\ndifferent contexts."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"nim-waku - the reference client written in Nim, most full-featured."),(0,o.kt)("li",{parentName:"ul"},"js-waku - allow usage of Waku v2 from browsers, focus on interacting with dapps."),(0,o.kt)("li",{parentName:"ul"},"go-waku - subset of Waku v2 to ease integration into the Status app.")),(0,o.kt)("h3",{id:"testnet-huilong-and-dogfooding"},"Testnet Huilong and dogfooding"),(0,o.kt)("p",null,"In order to test the protocol we have setup a testnet across all implementations\ncalled Huilong. Yes, that's the Taipei subway station!"),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(47600).Z,width:"3264",height:"2448"})),(0,o.kt)("p",null,"Among us core devs we have disabled the main #waku Discord channel used for\ndevelopment, and people run their own node connected to this toy chat application."),(0,o.kt)("p",null,"Feel free to join and say hi! Instructions can be found here:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/status-im/nim-waku/blob/master/docs/tutorial/chat2.md"},"nim-waku chat"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://status-im.github.io/js-waku/"},"js-waku chat"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/status-im/go-waku/tree/master/examples/chat2"},"go-waku chat")))),(0,o.kt)("h3",{id:"research"},"Research"),(0,o.kt)("p",null,"While Waku v2 is being used today, we are actively researching improvements.\nSince the design is modular, we can gracefully introduce new capabilities. Some\nof these research areas are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Privacy-preserving spam protection using zkSNARKs and RLN"),(0,o.kt)("li",{parentName:"ul"},"Accounting and settlement of resource usage to incentivize nodes to provide services with SWAP"),(0,o.kt)("li",{parentName:"ul"},"State synchronization for store protocol to make it easier to run a store node without perfect uptime"),(0,o.kt)("li",{parentName:"ul"},"Better node discovery"),(0,o.kt)("li",{parentName:"ul"},"More rigorous privacy analysis"),(0,o.kt)("li",{parentName:"ul"},"Improving interaction with wallets and dapp")),(0,o.kt)("h2",{id:"use-cases"},"Use cases"),(0,o.kt)("p",null,"Let's look at where Waku v2 is and can be used."),(0,o.kt)("h3",{id:"prelude-topics-in-waku-v2"},"Prelude: Topics in Waku v2"),(0,o.kt)("p",null,"To give some context, there are two different types of topics in Waku v2. One is\na PubSub topic, for routing. The other is a content topic, which is used for\ncontent based filtering. Here's an example of the default PubSub topic:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/waku/2/default-waku/proto")),(0,o.kt)("p",null,"This is recommended as it increases privacy for participants and it is stored by\ndefault, however this is up to the application."),(0,o.kt)("p",null,"The second type of topic is a content topic, which is application specific. For\nexample, here's the content topic used in our testnet:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"/toychat/2/huilong/proto")),(0,o.kt)("p",null,"For more on topics, see ",(0,o.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/waku/informational/23/topics"},"https://rfc.vac.dev/waku/informational/23/topics")),(0,o.kt)("h3",{id:"status-app"},"Status app"),(0,o.kt)("p",null,"In the Status protocol, content topics - topics in Whisper/Waku v1 - are used for several things:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Contact code topic to discover X3DH bundles for perfect forward secrecy",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Partitioned into N (currently 5000) content topics to balance privacy with efficiency"))),(0,o.kt)("li",{parentName:"ul"},"Public chats correspond to hash of the plaintext name"),(0,o.kt)("li",{parentName:"ul"},"Negotiated topic for 1:1 chat with DHKE derived content topic")),(0,o.kt)("p",null,"See more here ",(0,o.kt)("a",{parentName:"p",href:"http://rfc.vac.dev/status/deprecated/waku-usage"},"http://rfc.vac.dev/status/deprecated/waku-usage")),(0,o.kt)("p",null,"Currently, Status app is in the process of migrating to and testing Waku v2."),(0,o.kt)("h3",{id:"dappconnect-ethereum-messaging"},"DappConnect: Ethereum messaging"),(0,o.kt)("p",null,"It is easy to think of Waku as being for human messaging, since that's how it is\nprimarily used in the Status app, but the goal is to be useful for generalized\nmessaging, which includes Machine-To-Machine (M2M) messaging."),(0,o.kt)("p",null,"Recall the concept of the holy trinity with Ethereum/Swarm/Whisper and Web3 that\nwe mentioned in the beginning. Messaging can be used as a building block for\ndapps, wallets, and users to communicate with each other. It can be used for\nthings such as:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Multisig and DAO vote transactions only needing one on-chain operation"),(0,o.kt)("li",{parentName:"ul"},"Giving dapps ability to send push notifications to users"),(0,o.kt)("li",{parentName:"ul"},"Giving users ability to directly respond to requests from dapps"),(0,o.kt)("li",{parentName:"ul"},"Decentralized WalletConnect"),(0,o.kt)("li",{parentName:"ul"},"Etc")),(0,o.kt)("p",null,"Basically anything that requires communication and doesn't have to be on-chain."),(0,o.kt)("h3",{id:"walletconnect-v2"},"WalletConnect v2"),(0,o.kt)("p",null,"WalletConnect is an open protocol for connecting dapps to wallets with a QR\ncode. Version 2 is using Waku v2 as a communication channel to do so in a\ndecentralized and private fashion."),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(91764).Z,width:"809",height:"452"})),(0,o.kt)("p",null,"See for more: ",(0,o.kt)("a",{parentName:"p",href:"https://docs.walletconnect.org/v/2.0/tech-spec"},"https://docs.walletconnect.org/v/2.0/tech-spec")),(0,o.kt)("p",null,"WalletConnect v2 is currently in late alpha using Waku v2."),(0,o.kt)("h3",{id:"more-examples"},"More examples"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Gasless voting and vote aggregation off-chain"),(0,o.kt)("li",{parentName:"ul"},"Dapp games using Waku as player discovery mechanism"),(0,o.kt)("li",{parentName:"ul"},"Send encrypted message to someone with an Ethereum key"),(0,o.kt)("li",{parentName:"ul"},"<","Your dapp here",">")),(0,o.kt)("p",null,"These are all things that are in progress / proof of concept stage."),(0,o.kt)("h2",{id:"contribute"},"Contribute"),(0,o.kt)("p",null,"We'd love to see contributions of any form!"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You can play with it here: ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/status-im/nim-waku/blob/master/docs/tutorial/chat2.md"},"nim-waku chat")," (/ ",(0,o.kt)("a",{parentName:"li",href:"https://status-im.github.io/js-waku/"},"js-waku browser chat"),")"),(0,o.kt)("li",{parentName:"ul"},"Use Waku to build a dapp: ",(0,o.kt)("a",{parentName:"li",href:"https://status-im.github.io/js-waku/docs/"},"js-waku docs")),(0,o.kt)("li",{parentName:"ul"},"Contribute to code: ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/status-im/js-waku"},"js-waku")," / ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/status-im/nim-waku"},"nim-waku")),(0,o.kt)("li",{parentName:"ul"},"Contribute to specs: ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/vacp2p/rfc"},"vacp2p/rfc")),(0,o.kt)("li",{parentName:"ul"},"We are hiring: Wallet & Dapp Integration Developer, Distributed Systems Engineer, Protocol Engineer, Protocol Researcher - all ",(0,o.kt)("a",{parentName:"li",href:"https://status.im/our_team/jobs.html"},"job listings")),(0,o.kt)("li",{parentName:"ul"},"Join our new ",(0,o.kt)("a",{parentName:"li",href:"https://discord.gg/bJCTqS5H"},"Discord"))),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"In this talk we've gone over the original vision for Web3 and how Waku came to\nbe. We've also looked at what Waku v2 aims to do. We looked at its protocols,\nimplementations, the current testnet as well as briefly on some ongoing\nresearch for Vac."),(0,o.kt)("p",null,"We've also looked at some specific use cases for Waku. First we looked at how\nStatus uses it with different topics. Then we looked at how it can be useful for\nmessaging in Ethereum, including for things like WalletConnect."),(0,o.kt)("p",null,"I hope this talk gives you a better idea of what Waku is, why it exists, and\nthat it inspires you to contribute, either to Waku itself or by using it in your\nown project!"))}c.isMDXComponent=!0},3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),h=u(a),m=o,d=h["".concat(l,".").concat(m)]||h[m]||c[m]||i;return a?n.createElement(d,r(r({ref:t},p),{},{components:a})):n.createElement(d,r({ref:t},p))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var u=2;u<i;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},47600:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/huilong-8b4f76f3e4117a3d34d3e90c0baef066.jpg"},91764:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/walletconnect-62fa376651fb831e64e9a247d495bf53.png"}}]);