"use strict";(self.webpackChunkvac_dev=self.webpackChunkvac_dev||[]).push([[1750],{98071:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=n(87462),i=(n(67294),n(3905));const r={layout:"post",name:"Building Privacy-Protecting Infrastructure",title:"Building Privacy-Protecting Infrastructure",date:new Date("2022-11-04T12:00:00.000Z"),authors:"oskarth",published:!0,slug:"building-privacy-protecting-infrastructure",categories:"research",image:"/img/building_private_infra_intro.png",discuss:"https://forum.vac.dev/t/discussion-building-privacy-protecting-infrastructure/161"},o=void 0,s={permalink:"/rlog/building-privacy-protecting-infrastructure",source:"@site/rlog/2022-11-04-building-privacy-protecting-infrastructure.mdx",title:"Building Privacy-Protecting Infrastructure",description:"What is privacy-protecting infrastructure? Why do we need it and how we can build it? We'll look at Waku, the communication layer for Web3. We'll see how it uses ZKPs to incentivize and protect the Waku network. We'll also look at Zerokit, a library that makes it easier to use ZKPs in different environments. After reading this, I hope you'll better understand the importance of privacy-protecting infrastructure and how we can build it.",date:"2022-11-04T12:00:00.000Z",formattedDate:"November 4, 2022",tags:[],readingTime:18.595,hasTruncateMarker:!0,authors:[{name:"Oskar",twitter:"oskarth",github:"oskarth",key:"oskarth"}],frontMatter:{layout:"post",name:"Building Privacy-Protecting Infrastructure",title:"Building Privacy-Protecting Infrastructure",date:"2022-11-04T12:00:00.000Z",authors:"oskarth",published:!0,slug:"building-privacy-protecting-infrastructure",categories:"research",image:"/img/building_private_infra_intro.png",discuss:"https://forum.vac.dev/t/discussion-building-privacy-protecting-infrastructure/161"},prevItem:{title:"Waku for All Decentralized Applications and Infrastructures",permalink:"/rlog/waku-for-all"},nextItem:{title:"Waku Privacy and Anonymity Analysis Part I: Definitions and Waku Relay",permalink:"/rlog/wakuv2-relay-anon"}},l={authorsImageUrls:[void 0]},c=[{value:"Intro",id:"intro",level:3},{value:"About",id:"about",level:3},{value:"Why build privacy-protecting infrastructure?",id:"why-build-privacy-protecting-infrastructure",level:3},{value:"Web3 infrastructure",id:"web3-infrastructure",level:3},{value:"ZK for privacy-protecting infrastructure",id:"zk-for-privacy-protecting-infrastructure",level:3},{value:"Waku",id:"waku",level:3},{value:"Waku - adaptive nodes",id:"waku---adaptive-nodes",level:3},{value:"Waku - protocol interactions",id:"waku---protocol-interactions",level:3},{value:"Waku - Network",id:"waku---network",level:3},{value:"Dealing with network spam and RLN Relay",id:"dealing-with-network-spam-and-rln-relay",level:3},{value:"RLN - Overview and Flow",id:"rln---overview-and-flow",level:3},{value:"RLN - Circuit",id:"rln---circuit",level:3},{value:"RLN - Shamir&#39;s secret sharing",id:"rln---shamirs-secret-sharing",level:3},{value:"RLN Relay",id:"rln-relay",level:3},{value:"RLN Relay cross-client testnet",id:"rln-relay-cross-client-testnet",level:3},{value:"Private settlement / Service credentials",id:"private-settlement--service-credentials",level:3},{value:"Zerokit",id:"zerokit",level:3},{value:"Other research",id:"other-research",level:3},{value:"Summary",id:"summary",level:3}],u={toc:c};function h(e){let{components:t,...r}=e;return(0,i.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"What is privacy-protecting infrastructure? Why do we need it and how we can build it? We'll look at Waku, the communication layer for Web3. We'll see how it uses ZKPs to incentivize and protect the Waku network. We'll also look at Zerokit, a library that makes it easier to use ZKPs in different environments. After reading this, I hope you'll better understand the importance of privacy-protecting infrastructure and how we can build it."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"This write-up is based on a talk given at DevCon 6 in Bogota, a video can be found ",(0,i.kt)("a",{parentName:"em",href:"https://www.youtube.com/watch?v=CW1DYJifdhs"},"here"))),(0,i.kt)("h3",{id:"intro"},"Intro"),(0,i.kt)("p",null,"In this write-up, we are going to talk about building privacy-protecting\ninfrastructure. What is it, why do we need it and how can we build it?"),(0,i.kt)("p",null,"We'll look at Waku, the communication layer for Web3. We'll look at how we are\nusing Zero Knowledge (ZK) technology to incentivize and protect the Waku\nnetwork. We'll also look at Zerokit, a library we are writing to make ZKP easier\nto use in different environments."),(0,i.kt)("p",null,"At the end of this write-up, I hope you'll come away with an understanding of\nthe importance of privacy-protecting infrastructure and how we can build it."),(0,i.kt)("h3",{id:"about"},"About"),(0,i.kt)("p",null,"First, briefly about Vac. We build public good protocols for the decentralized\nweb, with a focus on privacy and communication. We do applied research based on\nwhich we build protocols, libraries and publications. We are also the custodians\nof protocols that reflect a set of principles."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Principles",src:n(62719).Z,width:"1204",height:"356"})),(0,i.kt)("p",null,"It has its origins in the ",(0,i.kt)("a",{parentName:"p",href:"https://status.im/"},"Status app")," and trying to improve\nthe underlying protocols and infrastructure. We build ",(0,i.kt)("a",{parentName:"p",href:"https://waku.org/"},"Waku"),",\namong other things."),(0,i.kt)("h3",{id:"why-build-privacy-protecting-infrastructure"},"Why build privacy-protecting infrastructure?"),(0,i.kt)("p",null,"Privacy is the power to selectively reveal yourself. It is a requirement for\nfreedom and self-determination."),(0,i.kt)("p",null,"Just like you need decentralization in order to get censorship-resistance, you\nneed privacy to enable freedom of expression."),(0,i.kt)("p",null,"To build applications that are decentralized and privacy-protecting, you need\nthe base layer, the infrastructure itself, to have those properties."),(0,i.kt)("p",null,"We see this a lot. It is easier to make trade-offs at the application layer than\ndoing them at the base layer. You can build custodial solutions on top of a\ndecentralized and non-custodial network where participants control their own\nkeys, but you can't do the opposite."),(0,i.kt)("p",null,"If you think about it, buildings can be seen as a form of privacy-protecting\ninfrastructure. It is completely normal and obvious in many ways, but when it\ncomes to the digital realm our mental models and way of speaking about it hasn't\ncaught up yet for most people."),(0,i.kt)("p",null,"I'm not going too much more into the need for privacy or what happens when you\ndon't have it, but suffice to say it is an important property for any open\nsociety."),(0,i.kt)("p",null,"When we have conversations, true peer-to-peer offline conversations, we can talk\nprivately. If we use cash to buy things we can do commerce privately."),(0,i.kt)("p",null,"On the Internet, great as it is, there are a lot of forces that makes this\nnatural state of things not the default. Big Tech has turned users into a\ncommodity, a product, and monetized user's attention for advertising. To\noptimize for your attention they need to surveil your habits and activities, and\nhence breach your privacy. As opposed to more old-fashioned models, where\nsomeone is buying a useful service from a company and the incentives are more\naligned."),(0,i.kt)("p",null,"We need to build credibly neutral infrastructure that protects your privacy at\nthe base layer, in order to truly enable applications that are\ncensorship-resistant and encourage meaningful freedom of expression."),(0,i.kt)("h3",{id:"web3-infrastructure"},"Web3 infrastructure"),(0,i.kt)("p",null,"Infrastructure is what lies underneath. Many ways of looking at this but I'll\nkeep it simple as per the original Web3 vision. You had Ethereum for\ncompute/consensus, Swarm for storage, and Whisper for messaging. Waku has taken\nover the mantle from Whisper and is a lot more\n",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/fixing-whisper-with-waku"},"usable")," today than Whisper ever was,\nfor many reasons."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Web3 Infrastructure",src:n(76544).Z,width:"1408",height:"826"})),(0,i.kt)("p",null,'On the privacy-front, we see how Ethereum is struggling. It is a big UX problem,\nespecially when you try to add privacy back "on top". It takes a lot of effort\nand it is easier to censor. We see this with recent action around Tornado Cash.\nCompare this with something like Zcash or Monero, where privacy is there by\ndefault.'),(0,i.kt)("p",null,"There are also problems when it comes to the p2p networking side of things, for\nexample with Ethereum validator privacy and hostile actors and jurisdictions. If\nsomeone can easily find out where a certain validator is physically located,\nthat's a problem in many parts of the world. Being able to have stronger\nprivacy-protection guarantees would be very useful for high-value targets."),(0,i.kt)("p",null,'This doesn\'t begin to touch on the so called "dapps" that make a lot of\nsacrifices in how they function, from the way domains work, to how websites are\nhosted and the reliance on centralized services for communication. We see this\ntime and time again, where centralized, single points of failure systems work\nfor a while, but then eventually fail.'),(0,i.kt)("p",null,"In many cases an individual user might not care enough though, and for platforms\nthe lure to take shortcuts is strong. That is why it is important to be\nprincipled, but also pragmatic in terms of the trade-offs that you allow on top.\nWe'll touch more on this in the design goals around modularity that Waku has."),(0,i.kt)("h3",{id:"zk-for-privacy-protecting-infrastructure"},"ZK for privacy-protecting infrastructure"),(0,i.kt)("p",null,"ZKPs are a wonderful new tool. Just like smart contracts enables programmable\nmoney, ZKPs allow us to express fundamentally new things. In line with the great\ntradition of trust-minimization, we can prove statement while revealing the\nabsolute minimum information necessary. This fits the definition of privacy, the\npower to selectively reveal yourself, perfectly. I'm sure I don't need to tell\nanyone reading this but this is truly revolutionary. The technology is advancing\nextremely fast and often it is our imagination that is the limit."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Zero knowledge",src:n(2416).Z,width:"1412",height:"930"})),(0,i.kt)("h3",{id:"waku"},"Waku"),(0,i.kt)("p",null,"What is Waku? It is a set of modular protocols for p2p communication. It has a\nfocus on privacy, security and being able to run anywhere. It is the spiritual\nsuccess to Whisper."),(0,i.kt)("p",null,"By modular we mean that you can pick and choose protocols and how you use them\ndepending on constraints and trade-offs. For example, bandwidth usage vs\nprivacy."),(0,i.kt)("p",null,"It is designed to work in resource restricted environments, such as mobile\nphones and in web browsers. It is important that infrastructure meets users\nwhere they are and supports their real-world use cases. Just like you don't need\nyour own army and a castle to have your own private bathroom, you shouldn't need\nto have a powerful always-on node to get reasonable privacy and\ncensorship-resistance. We might call this self-sovereignty."),(0,i.kt)("h3",{id:"waku---adaptive-nodes"},"Waku - adaptive nodes"),(0,i.kt)("p",null,"One way of looking at Waku is as an open service network. There are nodes with\nvarying degrees of capabilities and requirements. For example when it comes to\nbandwidth usage, storage, uptime, privacy requirements, latency requirements,\nand connectivity restrictions."),(0,i.kt)("p",null,"We have a concept of adaptive nodes that can run a variety of protocols. A node\noperator can choose which protocols they want to run. Naturally, there'll be\nsome nodes that do more consumption and other nodes that do more provisioning.\nThis gives rise to the idea of a service network, where services are provided\nfor and consumed."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Adaptive Nodes",src:n(23153).Z,width:"1408",height:"1098"})),(0,i.kt)("h3",{id:"waku---protocol-interactions"},"Waku - protocol interactions"),(0,i.kt)("p",null,"There are many protocols that interact. Waku Relay protocol is based on libp2p\nGossipSub for p2p messaging. We have filter for bandwidth-restricted nodes to\nonly receive subset of messages. Lightpush for nodes with short connection\nwindows to push messages into network. Store for nodes that want to retrieve\nhistorical messages."),(0,i.kt)("p",null,"On the payload layer, we provide support for Noise handshakes/key-exchanges.\nThis means that as a developers, you can get end-to-end encryption and expected\nguarantees out of the box. We have support for setting up a secure channel from\nscratch, and all of this paves the way for providing Signal's Double Ratchet at\nthe protocol level much easier. We also have experimental support for\nmulti-device usage. Similar features have existed in for example the Status app\nfor a while, but with this we make it easier for any platform using Waku to use\nit."),(0,i.kt)("p",null,"There are other protocols too, related to peer discovery, topic usage, etc. See\n",(0,i.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/"},"specs")," for more details."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Protocol Interactions",src:n(14158).Z,width:"1166",height:"1131"})),(0,i.kt)("h3",{id:"waku---network"},"Waku - Network"),(0,i.kt)("p",null,"For the Waku network, there are a few problems. For example, when it comes to\nnetwork spam and incentivizing service nodes. We want to address these while\nkeeping privacy-guarantees of the base layer. I'm going to go into both of\nthese."),(0,i.kt)("p",null,"The spam problem arises on the gossip layer when anyone can overwhelm the\nnetwork with messages. The service incentivization is a problem when nodes don't\ndirectly benefit from the provisioning of a certain service. This can happen if\nthey are not using the protocol directly themselves as part of normal operation,\nor if they aren't socially inclined to provide a certain service. This depends a\nlot on how an individual platform decides to use the network."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Waku Network",src:n(30962).Z,width:"1860",height:"980"})),(0,i.kt)("h3",{id:"dealing-with-network-spam-and-rln-relay"},"Dealing with network spam and RLN Relay"),(0,i.kt)("p",null,"Since the p2p relay network is open to anyone, there is a problem with spam. If\nwe look at existing solutions for dealing with spam in traditional messaging\nsystems, a lot of entities like Google, Facebook, Twitter, Telegram, Discord use\nphone number verification. While this is largely sybil-resistant, it is\ncentralized and not private at all."),(0,i.kt)("p",null,"Historically, Whisper used PoW which isn't good for heterogenerous networks.\nPeer scoring is open to sybil attacks and doesn't directly address spam\nprotection in an anonymous p2p network."),(0,i.kt)("p",null,"The key idea here is to use RLN for private economic spam protection using\nzkSNARKs."),(0,i.kt)("p",null,"I'm not going to go into too much detail of RLN here. If you are interested, I\ngave a ",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=g41nHQ0mLoA"},"talk")," in Amsterdam at\nDevconnect about this. We have some write-ups on RLN\n",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/rln-relay"},"here")," by Sanaz who has been pushing a lot of this\nfrom our side. There's also another talk at Devcon by Tyler going into RLN in\nmore detail. Finally, here's the ",(0,i.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/spec/32/"},"RLN spec"),"."),(0,i.kt)("p",null,"I'll briefly go over what it is, the interface and circuit and then talk about\nhow it is used in Waku."),(0,i.kt)("h3",{id:"rln---overview-and-flow"},"RLN - Overview and Flow"),(0,i.kt)("p",null,"RLN stands for Rate Limiting Nullifier. It is an anonyomous rate limiting\nmechanism based on zkSNARKs. By rate limiting we mean you can only send N\nmessages in a given period. By anonymity we mean that you can't link message to\na publisher. We can think of it as a voting booth, where you are only allowed to\nvote once every election."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Voting Booth",src:n(90369).Z,width:"703",height:"479"})),(0,i.kt)("p",null,"It can be used for spam protection in p2p messaging systems, and also rate\nlimiting in general, such as for a decentralized captcha."),(0,i.kt)("p",null,"There are three parts to it. You register somewhere, then you can signal and\nfinally there's a verification/slashing phase. You put some capital at risk,\neither economic or social, and if you double signal you get slashed."),(0,i.kt)("h3",{id:"rln---circuit"},"RLN - Circuit"),(0,i.kt)("p",null,"Here's what the private and public inputs to the circuit look like. The identity\nsecret is generated locally, and we create an identity commitment that is\ninserted into a Merkle tree. We then use Merkle proofs to prove membership.\nRegistered member can only signal once for a given epoch or external nullifier,\nfor example every ten seconds in Unix time. RLN identifer is for a specific RLN\napp."),(0,i.kt)("p",null,"We also see what the circuit output looks like. This is calculated locally. ",(0,i.kt)("inlineCode",{parentName:"p"},"y"),"\nis a share of the secret equation, and the (internal) nullifier acts as a unique\nfingerprint for a given app/user/epoch combination. How do we calculate ",(0,i.kt)("inlineCode",{parentName:"p"},"y")," and\nthe internal nullifier?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"// Private input\nsignal input identity_secret;\nsignal input path_elements[n_levels][1];\nsignal input identity_path_index[n_levels];\n\n// Public input\nsignal input x; // signal_hash\nsignal input epoch; // external_nullifier\nsignal input rln_identifier;\n\n// Circuit output\nsignal output y;\nsignal output root;\nsignal output nullifier;\n")),(0,i.kt)("h3",{id:"rln---shamirs-secret-sharing"},"RLN - Shamir's secret sharing"),(0,i.kt)("p",null,"This is done using ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Shamir%27s_Secret_Sharing"},"Shamir's secret\nsharing"),". Shamir\u2019s\nsecret sharing is based on idea of splitting a secret into shares. This is how\nwe enable slashing of funds."),(0,i.kt)("p",null,"In this case, we have two shares. If a given identity ",(0,i.kt)("inlineCode",{parentName:"p"},"a0")," signals twice in\nepoch/external nullifier, ",(0,i.kt)("inlineCode",{parentName:"p"},"a1")," is the same. For a given RLN app,\n",(0,i.kt)("inlineCode",{parentName:"p"},"internal_nullifier")," then stays the same. ",(0,i.kt)("inlineCode",{parentName:"p"},"x")," is signal hash which is different,\nand ",(0,i.kt)("inlineCode",{parentName:"p"},"y")," is public, so we can reconstruct ",(0,i.kt)("inlineCode",{parentName:"p"},"identity_secret"),". With the identity\nsecret revealed, this gives access to e.g. financial stake."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"a_0 = identity_secret // secret S\na_1 = poseidonHash([a0, external_nullifier])\n\ny = a_0 + x * a_1\n\ninternal_nullifier = poseidonHash([a_1, rln_identifier])\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Shamir&#39;s secret sharing",src:n(30188).Z,width:"936",height:"704"})),(0,i.kt)("h3",{id:"rln-relay"},"RLN Relay"),(0,i.kt)("p",null,"This is how RLN is used with Relay/GossipSub protocol. A node registers and\nlocks up funds, and after that it can send messages. It publishes a message\ncontaining the Zero Knowledge proof and some other details."),(0,i.kt)("p",null,"Each relayer node listens to the membership contract for new members, and it\nalso keeps track of relevant metadata and merkle tree. Metadata is needed to be\nable to detect double signaling and perform slashing."),(0,i.kt)("p",null,"Before forwarding a message, it does some verification checks to ensure there\nare no duplicate messages, ZKP is valid and no double signaling has occured. It\nis worth noting that this can be combined with peer scoring, for example for\nduplicate messages or invalid ZK proofs."),(0,i.kt)("p",null,"In line of Waku's goals of modularity, RLN Relay is applied on a specific subset\nof pubsub and content topics. You can think of it as an extra secure channel."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"RLN Relay",src:n(95453).Z,width:"1874",height:"995"})),(0,i.kt)("h3",{id:"rln-relay-cross-client-testnet"},"RLN Relay cross-client testnet"),(0,i.kt)("p",null,"Where are we with RLN Relay deployment? We've recently launched our second\ntestnet. This is using RLN Relay with a smart contract on Goerli. It integrates\nwith our example p2p chat application, and it does so through three different\nclients, nwaku, go-waku and js-waku for browsers. This is our first p2p\ncross-client testnet for RLN Relay."),(0,i.kt)("p",null,"Here's a ",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=-vVrJWW0fls"},"video")," that shows a user\nregistering in a browser, signaling through JS-Waku. It then gets relayed to a\nnwaku node, that verifies the proof. The second\n",(0,i.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=Xz5q2ZhkFYs"},"video")," shows what happens in the\nspam case. when more than one message is sent in a given epoch, it detects it as\nspam and discards it. Slashing hasn't been implemented fully yet in the client\nand is a work in progress."),(0,i.kt)("p",null,"If you are curious and want to participate, you can join the effort on our ",(0,i.kt)("a",{parentName:"p",href:"https://discord.gg/PQFdubGt6d"},"Vac\nDiscord"),". We also have\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/status-im/nwaku/blob/master/docs/tutorial/rln-chat-cross-client.md"},"tutorials"),"\nsetup for all clients so you can play around with it."),(0,i.kt)("p",null,"As part of this, and to make it work in multiple different environments, we've\nalso been developing a new library called Zerokit. I'll talk about this a bit\nlater."),(0,i.kt)("h3",{id:"private-settlement--service-credentials"},"Private settlement / Service credentials"),(0,i.kt)("p",null,"Going back to the service network idea, let's talk about service credentials.\nThe idea behind service credentials and private settlement is to enable two\nactors to pay for and provide services without compromising their privacy. We do\nnot want the payment to create a direct public link between the service provider\nand requester."),(0,i.kt)("p",null,"Recall the Waku service network illustration with adaptive nodes that choose\nwhich protocols they want to run. Many of these protocols aren't very heavy and\njust work by default. For example the relay protocol is enabled by default.\nOther protocols are much heavier to provide, such as storing historical\nmessages."),(0,i.kt)("p",null,"It is desirable to have additional incentives for this, especially for platforms\nthat aren't community-based where some level of altruism can be assumed (e.g.\nStatus Communities, or WalletConnect cloud infrastructure)."),(0,i.kt)("p",null,"You have a node Alice that is often offline and wants to consume historical\nmessages on some specific content topics. You have another node Bob that runs a\nserver at home where they store historical messages for the last several weeks.\nBob is happy to provide this service for free because he's excited about running\nprivacy-preserving infrastructure and he's using it himself, but his node is\ngetting overwhelmed by freeloaders and he feels like he should be paid something\nfor continuing to provide this service."),(0,i.kt)("p",null,"Alice deposits some funds in a smart contract which registers it in a tree,\nsimilar to certain other private settlement mechanisms. A fee is taken or\nburned. In exchange, she gets a set of tokens or service credentials. When she\nwants to do a query with some criteria, she sends this to Bob. Bob responds with\nsize of response, cost, and receiver address. Alice then sends a proof of\ndelegation of a service token as a payment. Bob verifies the proof and resolves\nthe query."),(0,i.kt)("p",null,"The end result is that Alice has consumed some service from Bob, and Bob has\nreceived payment for this. There's no direct transaction link between Alice and\nBob, and gas fees can be minimized by extending the period before settling on\nchain."),(0,i.kt)("p",null,"This can be complemented with altruistic service provisioning, for example by\nsplitting the peer pool into two slots, or only providing a few cheap queries\nfor free."),(0,i.kt)("p",null,"The service provisioning is general, and can be generalized for any kind of\nrequest/response service provisoning that we want to keep private."),(0,i.kt)("p",null,"This isn't a perfect solution, but it is an incremental improvement on top of\nthe status quo. It can be augmented with more advanced techniques such as better\nnon-repudiable node reputation, proof of correct service provisioning, etc."),(0,i.kt)("p",null,"We are currently in the raw spec / proof of concept stage of this. We expect to\nlaunch a testnet of this later this year or early next year."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Service credentials flow",src:n(15083).Z,width:"1414",height:"1022"})),(0,i.kt)("h3",{id:"zerokit"},"Zerokit"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/vacp2p/zerokit"},"Zerokit")," is a set of Zero Knowledge modules,\nwritten in Rust and designed to be used in many different environments. The\ninitial goal is to get the best of both worlds with Circom/Solidity/JS and\nRust/ZK ecosystem. This enables people to leverage Circom-based constructs from\nnon-JS environments."),(0,i.kt)("p",null,"For the RLN module, it is using Circom circuits via ark-circom and Rust for\nscaffolding. It exposes a C FFI API that can be used through other system\nprogramming environments, like Nim and Go. It also exposes an experimental WASM\nAPI that can be used through web browsers."),(0,i.kt)("p",null,"Waku is p2p infrastructure running in many different environments, such as\nNim/JS/Go/Rust, so this a requirement for us."),(0,i.kt)("p",null,"Circom and JS strengths are access to Dapp developers, tooling, generating\nverification code, circuits etc. Rust strengths is that it is systems-based and\neasy to interface with other language runtime such as Nim, Go, Rust, C. It also\ngives access to other Rust ZK ecosystems such as arkworks. This opens door for\nusing other constructs, such as Halo2. This becomes especially relevant for\nconstructs where you don't want to do a trusted setup or where circuits are more\ncomplex/custom and performance requirements are higher."),(0,i.kt)("p",null,"In general with Zerokit, we want to make it easy to build and use ZKP in a\nmultitude of environments, such as mobile phones and web browsers. Currently it\nis too complex to write privacy-protecting infrastructure with ZKPs considering\nall the languages and tools you have to learn, from JS, Solidity and Circom to\nRust, WASM and FFI. And that isn't even touching on things like secure key\nstorage or mobile dev. Luckily more and more projects are working on this,\nincluding writing DSLs etc. It'd also be exciting if we can make a useful\ntoolstack for JS-less ZK dev to reduce cognitive overhead, similar to what we\nhave with something like Foundry."),(0,i.kt)("h3",{id:"other-research"},"Other research"),(0,i.kt)("p",null,"I also want to mention a few other things we are doing. One thing is\n",(0,i.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/"},"protocol specifications"),". We think this is very important\nfor p2p infra, and we see a lot of other projects that claim to do it p2p\ninfrastructure but they aren't clear about guarantees or how stable something\nis. That makes it hard to have multiple implementations, to collaborate across\ndifferent projects, and to analyze things objectively."),(0,i.kt)("p",null,"Related to that is publishing ",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/publications"},"papers"),". We've put\nout three so far, related to Waku and RLN-Relay. This makes it easier to\ninterface with academia. There's a lot of good researchers out there and we want\nto build a better bridge between academia and industry."),(0,i.kt)("p",null,"Another thing is ",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/wakuv2-relay-anon"},"network"),"\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/vacp2p/research/issues/107"},"privacy"),". Waku is modular with\nrespect to privacy guarantees, and there are a lot of knobs to turn here\ndepending on specific deployments. For example, if you are running the full\nrelay protocol you currently have much stronger receiver anonymity than if you\nare running filter protocol from a bandwidth or connectivity-restricted node."),(0,i.kt)("p",null,"We aim to make this pluggable depending on user needs. E.g. mixnets such as Nym\ncome with some trade-offs but are a useful tool in the arsenal. A good mental\nmodel to keep in mind is the anonymity trilemma, where you can only pick 2/3 out\nof low latency, low bandwidth usage and strong anonymity."),(0,i.kt)("p",null,"We are currently exploring ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/vacp2p/research/issues/119"},"Dandelion-like\nadditions")," to the relay/gossip\nprotocol, which would provide for stronger sender anonymity, especially in a\nmulti-node/botnet attacker model. As part of this we are looking into different\nparameters choices and general possibilities for lower latency usage. This could\nmake it more amenable for latency sensitive environments, such as validator\nprivacy, for specific threat models. The general theme here is we want to be\nrigorous with the guarantees we provide, under what conditions and for what\nthreat models."),(0,i.kt)("p",null,"Another thing mentioned earlier is ",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/wakuv2-noise"},"Noise payload\nencryption"),", and specifically things like allowing\nfor pairing different devices with e.g. QR codes. This makes it easier for\ndevelopers to provide secure messaging in many realistic scenarios in a\nmulti-device world."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Other research",src:n(35306).Z,width:"1662",height:"1156"})),(0,i.kt)("h3",{id:"summary"},"Summary"),(0,i.kt)("p",null,"We've gone over what privacy-protecting infrastructure is, why we want it and\nhow we can build it. We've seen how ZK is a fundamental building block for this.\nWe've looked at Waku, the communication layer for Web3, and how it uses Zero\nKnowledge proofs to stay private and function better. We've also looked at\nZerokit and how we can make it easier to do ZKP in different environments."),(0,i.kt)("p",null,"Finally we also looked at some other research we've been doing. All of the\nthings mentioned in this article, and more, is available as\n",(0,i.kt)("a",{parentName:"p",href:"https://vac.dev/research"},"write-ups"),", ",(0,i.kt)("a",{parentName:"p",href:"https://rfc.vac.dev/"},"specs"),", or\ndiscussions on our ",(0,i.kt)("a",{parentName:"p",href:"forum.vac.dev/"},"forum")," or ",(0,i.kt)("a",{parentName:"p",href:"github.com/vacp2p/"},"Github"),"."),(0,i.kt)("p",null,"If you find any of this exciting to work on, feel free to reach out on our\nDiscord. We are also ",(0,i.kt)("a",{parentName:"p",href:"https://jobs.status.im/"},"hiring"),", and we have started\nexpanding into other privacy infrastructure tech like private and provable\ncomputation with ZK-WASM."))}h.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),d=i,m=p["".concat(l,".").concat(d)]||p[d]||h[d]||r;return n?a.createElement(m,o(o({ref:t},u),{},{components:n})):a.createElement(m,o({ref:t},u))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},23153:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_adaptive-69974a7e087e209572e1c2faf162e5d5.png"},14158:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_interactions-8e9eee38a9a67973c36d11d111bdc384.png"},35306:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_misc-16721ea7c68873dbb0276ae7fe665ae5.png"},30962:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_network-43aa536967aee45b44a1e2a6673b6941.png"},62719:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_principles-699c52e62e0e4de0843ddb23ffbed365.png"},95453:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_rlnrelay-4823f37fce52d9d44d72ca73028fa9b8.png"},15083:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_servicecred-b022d763d66e89fb610d8d4552355e3c.png"},30188:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_shamir-8f4c8e31d2eaa86b62392514a411b999.png"},90369:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_vote-a5992b54f4076642acc8e20ac716c750.png"},2416:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/building_private_infra_zk-61dc3331f70705c672242b894bc35ab8.png"},76544:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/web3_holy_trinity-fd2023ba2271927950dc70bb56f3c615.png"}}]);